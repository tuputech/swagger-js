{"version":3,"sources":["webpack://SwaggerClient/webpack/bootstrap","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/keys\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/array/is-array\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/typeof\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/assign\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/regenerator\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/defineProperty\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/define-property\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/define-properties\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/json/stringify\"","webpack://SwaggerClient/external \"url\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/toConsumableArray\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/promise\"","webpack://SwaggerClient/external \"lodash/assign\"","webpack://SwaggerClient/external \"lodash/get\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/asyncToGenerator\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/get-iterator\"","webpack://SwaggerClient/external \"fast-json-patch\"","webpack://SwaggerClient/external \"btoa\"","webpack://SwaggerClient/external \"lodash/startsWith\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/slicedToArray\"","webpack://SwaggerClient/external \"js-yaml\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/classCallCheck\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/createClass\"","webpack://SwaggerClient/external \"qs\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/object/create\"","webpack://SwaggerClient/external \"querystring-browser\"","webpack://SwaggerClient/external \"lodash/isObject\"","webpack://SwaggerClient/external \"buffer/\"","webpack://SwaggerClient/external \"lodash/isString\"","webpack://SwaggerClient/external \"lodash/find\"","webpack://SwaggerClient/external \"deep-extend\"","webpack://SwaggerClient/external \"@kyleshockey/object-assign-deep\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/core-js/weak-map\"","webpack://SwaggerClient/external \"cross-fetch\"","webpack://SwaggerClient/external \"traverse\"","webpack://SwaggerClient/external \"lodash/pick\"","webpack://SwaggerClient/external \"@babel/runtime-corejs2/helpers/objectWithoutProperties\"","webpack://SwaggerClient/external \"lodash/isPlainObject\"","webpack://SwaggerClient/external \"lodash/isArray\"","webpack://SwaggerClient/external \"cookie\"","webpack://SwaggerClient/external \"utf8-bytes\"","webpack://SwaggerClient/external \"utfstring\"","webpack://SwaggerClient/external \"lodash/cloneDeep\"","webpack://SwaggerClient/external \"cross-fetch/polyfill\"","webpack://SwaggerClient/external \"isomorphic-form-data\"","webpack://SwaggerClient/external \"encode-3986\"","webpack://SwaggerClient/./src/http.js","webpack://SwaggerClient/./src/specmap/lib/index.js","webpack://SwaggerClient/./src/specmap/lib/create-error.js","webpack://SwaggerClient/./src/specmap/helpers.js","webpack://SwaggerClient/./src/constants.js","webpack://SwaggerClient/./src/specmap/lib/refs.js","webpack://SwaggerClient/./src/specmap/lib/all-of.js","webpack://SwaggerClient/./src/specmap/lib/parameters.js","webpack://SwaggerClient/./src/specmap/lib/properties.js","webpack://SwaggerClient/./src/specmap/lib/context-tree.js","webpack://SwaggerClient/./src/specmap/index.js","webpack://SwaggerClient/./src/helpers.js","webpack://SwaggerClient/./src/resolver.js","webpack://SwaggerClient/./src/subtree-resolver/index.js","webpack://SwaggerClient/./src/interfaces.js","webpack://SwaggerClient/./src/execute/swagger2/parameter-builders.js","webpack://SwaggerClient/./src/execute/oas3/style-serializer.js","webpack://SwaggerClient/./src/execute/oas3/content-serializer.js","webpack://SwaggerClient/./src/execute/oas3/parameter-builders.js","webpack://SwaggerClient/./src/execute/oas3/build-request.js","webpack://SwaggerClient/./src/execute/swagger2/build-request.js","webpack://SwaggerClient/./src/execute/index.js","webpack://SwaggerClient/./src/index.js"],"names":["self","serializeRes","mergeInQueryOrForm","http","url","request","headers","forEach","headerName","value","replace","requestInterceptor","contentType","test","userFetch","fetch","res","responseInterceptor","error","Error","statusText","statusCode","status","responseError","ok","response","shouldDownloadAsText","parseBody","body","indexOf","JSON","parse","jsYaml","safeLoad","oriRes","loadSpec","serializeHeaders","useText","getBody","text","blob","buffer","call","then","data","obj","e","parseError","headerValue","header","undefined","push","isFile","navigatorObj","navigator","product","uri","File","pipe","formatValue","input","skipEncoding","collectionFormat","allowEmptyValue","SEPARATORS","csv","ssv","tsv","pipes","encodeFn","encodeURIComponent","isString","str","map","join","encodeFormOrQuery","encodedQuery","reduce","result","parameterName","isObject","a","paramValue","encodedParameterName","notArray","qs","stringify","encode","indices","req","query","form","joinSearch","strs","search","filter","hasFile","some","key","FormData","require","i","length","append","split","baseUrl","oriSearch","newStr","oriQuery","keysToRemove","finalStr","makeHttp","httpFn","preFetch","postFetch","add","remove","merge","mergeDeep","context","getIn","applyPatch","parentPathMatch","flatten","fullyNormalizeArray","normalizeArray","isPromise","forEachNew","forEachNewPrimitive","isJsonPatch","isContextPatch","isPatch","isMutation","isAdditiveMutation","isGenerator","isFunction","isError","patch","opts","path","normalizeJSONPath","op","newValue","getInByJsonPath","jsonPatch","currentValue","prop","propVal","isArray","existing","concat","currentObj","Object","prototype","hasOwnProperty","deepExtend","deepAssign","patches","arr","allowMetaPatches","meta","item","_get","type","mutations","fn","forEachNewPatch","forEachPrimitive","callback","mutation","flat","clean","cleanArray","basePath","val","results","newResults","arrayResults","moreResults","len","token","elm","thing","regenerator","isGeneratorFunction","jsonPath","getValueByPointer","console","createErrorType","name","init","E","captureStackTrace","stack","constructor","args","message","apply","freelyNamedKeyParents","nonFreelyNamedKeyGrandparents","freelyNamedPaths","freelyNamedAncestors","isFreelyNamed","parentPath","parentKey","grandparentKey","parentStr","el","generateAbsoluteRefPatches","specmap","getBaseUrlForNodePath","getContext","baseDoc","targetKeys","traverse","nodePath","fullPath","absolutifiedRefValue","absolutifyPointer","node","pointer","urlPart","fragmentPart","newRefUrlPart","URL","resolve","ACCEPT_HEADER_VALUE_FOR_DOCUMENTS","ABSOLUTE_URL_REGEXP","RegExp","JSONRefError","createError","extra","oriError","originalError","docCache","specmapRefs","skipResolutionTestFns","shouldSkipResolution","plugin","ref","specmapInstance","getInstance","parent","slice","$ref","splitString","refPath","absoluteify","wrapError","promOrVal","tokens","pointerAlreadyInPath","useCircularStructures","absolutifiedRef","lib","jsonPointerToArray","get","extractFromDoc","__value","catch","$$ref","patchValueAlreadyInPath","state","mod","clearCache","getDoc","fetchJSON","extract","unescapeJsonPointerToken","code","docPath","doc","v","reject","_doc","Accept","TypeError","substr","unescape","escapeJsonPointerToken","escape","arrayToJsonPointer","pointerBoundaryChar","c","pointerIsAParent","parentPointer","nextChar","charAt","lastParentChar","refs","set","fullyQualifiedPointer","safeParentPointer","rootDoc","contextTree","currPath","hasIndirectCycle","root","ancestors","p","pointToAncestor","k","err","alreadyAddError","originalDefinitionObj","part","allOf","toMerge","collapsedFullPath","absoluteRefPatches","parameters","opPath","spec","param","default","parameterMacro","properties","modelPropertyMacro","ContextTree","createNode","getParent","updateNode","children","branch","child","protoValue","ensureExists","HARD_LIMIT","SpecMap","debugLevel","plugins","pluginHistory","errors","promisedPatches","showDebug","allPatches","pluginProp","libMethods","bind","_getContext","hasRun","_hasRun","wrappedPlugins","wrapPlugin","updatePatches","level","log","pathDiscriminator","ctx","createKeyBasedPlugin","pluginName","pluginObj","isSubPath","tested","every","parentIndex","indexOfFirstProperties","isRootProperties","traversed","refCache","updatedPath","isObj","objRef","isWithinPathDiscriminator","find","getMutationsForPlugin","race","getPluginName","getPluginHistory","history","mi","getPluginHistoryTip","mutationIndex","debug","promisedPatchThen","setContext","updateMutations","index","splice","promisedPatch","removePromisedPatch","from","to","getCurrentPlugin","tip","getPluginMutationIndex","getMutations","currentPlugin","count","times","getPluginRunCount","that","nextPlugin","nextPromise","nextPromisedPatch","dispatch","pluginCount","promises","all","promise","Function","executePlugin","getCurrentMutations","lastMutationIndex","getLib","yieldedPatches","newPatches","updatePluginHistory","mapSpec","toLower","String","toLowerCase","escapeString","isOAS3","oasVersion","openapi","startsWith","isSwagger2","swaggerVersion","swagger","opId","operation","pathName","method","v2OperationIdCompatibilityMode","idWithoutWhitespace","operationId","idFromPathMethod","substring","legacyIdFromPathMethod","getOperationRaw","id","paths","findOperation","rawOperationId","legacyOperationId","predicate","eachOperation","cb","toUpperCase","operationObj","cbValue","normalizeSwagger","parsedSpec","$$normalized","pathParameters","oid","opList","o","__originalOperationId","inheritsList","toBeInherit","inherits","inheritName","exists","opParam","makeFetchJSON","credentials","withCredentials","mode","skipNormalization","Http","doResolve","_spec","plugs","resolveSubtree","returnEntireTree","resolveOptions","normalized","nullFn","arg","mapTagOperations","makeExecute","swaggerJs","execute","pick","makeApisTagOperationsOperationExecute","tagOperations","apis","tag","operations","makeApisTagOperation","defaultTag","operationIdCounter","tags","tagObj","cbResult","originalCounterValue","temp","bodyBuilder","headerBuilder","queryBuilder","pathBuilder","formData","formDataBuilder","parameter","paramName","isRfc3986Reserved","char","isRrc3986Unreserved","encodeDisallowedCharacters","toString","stringToCharArray","encoded","toUTF8Bytes","byte","encodedByte","stylize","config","encodeArray","encodeObject","encodePrimitive","style","explode","valueEncoder","prev","curr","after","valueKeys","middleChar","prefix","separator","serialize","mediaType","includes","content","effectiveMediaType","styledValue","allowReserved","encodedParamName","PARAMETER_HEADER_BLACKLIST","cookie","Cookie","options","requestBody","securities","attachContentTypeForEmptyPayload","requestContentType","applySecurities","requestBodyDef","requestBodyMediaTypes","isExplicitContentTypeValid","firstMediaType","newVal","Blob","Buffer","isBuffer","assign","authorized","security","isAuthorized","securityDef","securityObj","auth","schema","in","cookies","scheme","username","password","btoa","Authorization","tokenName","tokenValue","tokenType","token_type","consumes","isBodyParamPresent","isFormDataParamPresent","specSecurity","securityDefinitions","oauthToken","inType","authorization","base64","arrayOrEmpty","ar","OperationNotFoundError","findParametersWithName","deduplicateParameters","paramsMap","dedupedParameters","buildRequest","userHttp","extras","stockHttp","isPlainObject","responseContentType","contextUrl","server","serverVariables","parameterBuilders","specIsOAS3","OAS3_PARAMETER_BUILDERS","SWAGGER2_PARAMETER_BUILDERS","operationRaw","accept","combinedParameters","builder","warn","required","versionSpecificOptions","oas3BuildRequest","swagger2BuildRequest","cookieString","cookieName","cookieValue","stringified","stripNonAlpha","oas3BaseUrl","swagger2BaseUrl","servers","selectedServerUrl","selectedServerObj","serverUrls","srv","varNames","getVariableTemplateNames","vari","variables","variableDefinition","variableValue","re","buildOas3UrlWithContext","ourUrl","parsedUrl","parsedContextUrl","computedScheme","protocol","computedHost","host","computedPath","pathname","exec","firstSchemeInSpec","schemes","Swagger","Resolver","helpers","prom","disableInterfaces","client","argHash","applyDefaults","authorizations","originalSpec","specUrl","parsed","Url"],"mappings":";;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;AClFA,uE;;;;;;ACAA,0E;;;;;;ACAA,kE;;;;;;ACAA,yE;;;;;;ACAA,+D;;;;;;ACAA,+F;;;;;;ACAA,8F;;;;;;ACAA,2F;;;;;;ACAA,0E;;;;;;ACAA,kF;;;;;;ACAA,oF;;;;;;ACAA,0E;;;;;;ACAA,gC;;;;;;ACAA,6E;;;;;;ACAA,mE;;;;;;ACAA,0C;;;;;;ACAA,uC;;;;;;ACAA,4E;;;;;;ACAA,wE;;;;;;ACAA,4C;;;;;;ACAA,iC;;;;;;ACAA,8C;;;;;;ACAA,yE;;;;;;ACAA,oC;;;;;;ACAA,0E;;;;;;ACAA,uE;;;;;;ACAA,+B;;;;;;ACAA,yE;;;;;;ACAA,gD;;;;;;ACAA,4C;;;;;;ACAA,oC;;;;;;ACAA,4C;;;;;;ACAA,wC;;;;;;ACAA,wC;;;;;;ACAA,4D;;;;;;ACAA,oE;;;;;;ACAA,wC;;;;;;ACAA,qC;;;;;;ACAA,wC;;;;;;ACAA,mF;;;;;;ACAA,iD;;;;;;ACAA,2C;;;;;;ACAA,mC;;;;;;ACAA,uC;;;;;;ACAA,sC;;;;;;;;;;;;;ACAA,6C;;;;;;ACAA,iD;;;;;;ACAA,iD;;;;;;ACAA,wC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 45);\n","module.exports = require(\"@babel/runtime-corejs2/core-js/object/keys\");","module.exports = require(\"@babel/runtime-corejs2/core-js/array/is-array\");","module.exports = require(\"@babel/runtime-corejs2/helpers/typeof\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/assign\");","module.exports = require(\"@babel/runtime-corejs2/regenerator\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/get-own-property-descriptors\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/get-own-property-descriptor\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/get-own-property-symbols\");","module.exports = require(\"@babel/runtime-corejs2/helpers/defineProperty\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/define-property\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/define-properties\");","module.exports = require(\"@babel/runtime-corejs2/core-js/json/stringify\");","module.exports = require(\"url\");","module.exports = require(\"@babel/runtime-corejs2/helpers/toConsumableArray\");","module.exports = require(\"@babel/runtime-corejs2/core-js/promise\");","module.exports = require(\"lodash/assign\");","module.exports = require(\"lodash/get\");","module.exports = require(\"@babel/runtime-corejs2/helpers/asyncToGenerator\");","module.exports = require(\"@babel/runtime-corejs2/core-js/get-iterator\");","module.exports = require(\"fast-json-patch\");","module.exports = require(\"btoa\");","module.exports = require(\"lodash/startsWith\");","module.exports = require(\"@babel/runtime-corejs2/helpers/slicedToArray\");","module.exports = require(\"js-yaml\");","module.exports = require(\"@babel/runtime-corejs2/helpers/classCallCheck\");","module.exports = require(\"@babel/runtime-corejs2/helpers/createClass\");","module.exports = require(\"qs\");","module.exports = require(\"@babel/runtime-corejs2/core-js/object/create\");","module.exports = require(\"querystring-browser\");","module.exports = require(\"lodash/isObject\");","module.exports = require(\"buffer/\");","module.exports = require(\"lodash/isString\");","module.exports = require(\"lodash/find\");","module.exports = require(\"deep-extend\");","module.exports = require(\"@kyleshockey/object-assign-deep\");","module.exports = require(\"@babel/runtime-corejs2/core-js/weak-map\");","module.exports = require(\"cross-fetch\");","module.exports = require(\"traverse\");","module.exports = require(\"lodash/pick\");","module.exports = require(\"@babel/runtime-corejs2/helpers/objectWithoutProperties\");","module.exports = require(\"lodash/isPlainObject\");","module.exports = require(\"lodash/isArray\");","module.exports = require(\"cookie\");","module.exports = require(\"utf8-bytes\");","module.exports = require(\"utfstring\");","module.exports = require(\"lodash/cloneDeep\");","module.exports = require(\"cross-fetch/polyfill\");","module.exports = require(\"isomorphic-form-data\");","module.exports = require(\"encode-3986\");","import 'cross-fetch/polyfill' /* global fetch */\nimport qs from 'qs'\nimport jsYaml from 'js-yaml'\nimport isString from 'lodash/isString'\n\n// For testing\nexport const self = {\n  serializeRes,\n  mergeInQueryOrForm\n}\n\n// Handles fetch-like syntax and the case where there is only one object passed-in\n// (which will have the URL as a property). Also serilizes the response.\nexport default async function http(url, request = {}) {\n  if (typeof url === 'object') {\n    request = url\n    url = request.url\n  }\n\n  request.headers = request.headers || {}\n\n  // Serializes query, for convenience\n  // Should be the last thing we do, as its hard to mutate the URL with\n  // the search string, but much easier to manipulate the req.query object\n  self.mergeInQueryOrForm(request)\n\n  // Newlines in header values cause weird error messages from `window.fetch`,\n  // so let's massage them out.\n  // Context: https://stackoverflow.com/a/50709178\n  if (request.headers) {\n    Object.keys(request.headers).forEach((headerName) => {\n      const value = request.headers[headerName]\n\n      if (typeof value === 'string') {\n        request.headers[headerName] = value.replace(/\\n+/g, ' ')\n      }\n    })\n  }\n\n  // Wait for the request interceptor, if it was provided\n  // WARNING: don't put anything between this and the request firing unless\n  // you have a good reason!\n  if (request.requestInterceptor) {\n    request = await request.requestInterceptor(request) || request\n  }\n\n  // for content-type=multipart\\/form-data remove content-type from request before fetch\n  // so that correct one with `boundary` is set\n  const contentType = request.headers['content-type'] || request.headers['Content-Type']\n  if (/multipart\\/form-data/i.test(contentType)) {\n    delete request.headers['content-type']\n    delete request.headers['Content-Type']\n  }\n\n  // eslint-disable-next-line no-undef\n  let res\n  try {\n    res = await (request.userFetch || fetch)(request.url, request)\n    res = await self.serializeRes(res, url, request)\n    if (request.responseInterceptor) {\n      res = await request.responseInterceptor(res) || res\n    }\n  }\n  catch (resError) {\n    if (!res) {\n      // res is completely absent, so we can't construct our own error\n      // so we'll just throw the error we got\n      throw resError\n    }\n    const error = new Error(res.statusText)\n    error.statusCode = error.status = res.status\n    error.responseError = resError\n    throw error\n  }\n  if (!res.ok) {\n    const error = new Error(res.statusText)\n    error.statusCode = error.status = res.status\n    error.response = res\n    throw error\n  }\n  return res\n}\n\n// exported for testing\nexport const shouldDownloadAsText = (contentType = '') => /(json|xml|yaml|text)\\b/.test(contentType)\n\nfunction parseBody(body, contentType) {\n  if (contentType && (contentType.indexOf('application/json') === 0 || contentType.indexOf('+json') > 0)) {\n    return JSON.parse(body)\n  }\n  return jsYaml.safeLoad(body)\n}\n\n// Serialize the response, returns a promise with headers and the body part of the hash\nexport function serializeRes(oriRes, url, {loadSpec = false} = {}) {\n  const res = {\n    ok: oriRes.ok,\n    url: oriRes.url || url,\n    status: oriRes.status,\n    statusText: oriRes.statusText,\n    headers: serializeHeaders(oriRes.headers)\n  }\n\n  const contentType = res.headers['content-type']\n  const useText = loadSpec || shouldDownloadAsText(contentType)\n\n  // Note: Response.blob not implemented in node-fetch 1.  Use buffer instead.\n  const getBody = useText ? oriRes.text : (oriRes.blob || oriRes.buffer)\n\n  return getBody.call(oriRes).then((body) => {\n    res.text = body\n    res.data = body\n\n    if (useText) {\n      try {\n        const obj = parseBody(body, contentType)\n        res.body = obj\n        res.obj = obj\n      }\n      catch (e) {\n        res.parseError = e\n      }\n    }\n    return res\n  })\n}\n\n// Serialize headers into a hash, where mutliple-headers result in an array.\n//\n// eg: Cookie: one\n//     Cookie: two\n//  =  { Cookie: [ \"one\", \"two\" ]\nexport function serializeHeaders(headers = {}) {\n  const obj = {}\n\n  // Iterate over headers, making multiple-headers into an array\n  if (typeof headers.forEach === 'function') {\n    headers.forEach((headerValue, header) => {\n      if (obj[header] !== undefined) {\n        obj[header] = Array.isArray(obj[header]) ? obj[header] : [obj[header]]\n        obj[header].push(headerValue)\n      }\n      else {\n        obj[header] = headerValue\n      }\n    })\n    return obj\n  }\n\n  return obj\n}\n\nexport function isFile(obj, navigatorObj) {\n  if (!navigatorObj && typeof navigator !== 'undefined') {\n    // eslint-disable-next-line no-undef\n    navigatorObj = navigator\n  }\n  if (navigatorObj && navigatorObj.product === 'ReactNative') {\n    if (obj && typeof obj === 'object' && typeof obj.uri === 'string') {\n      return true\n    }\n    return false\n  }\n  if (typeof File !== 'undefined') {\n    // eslint-disable-next-line no-undef\n    return obj instanceof File\n  }\n  return obj !== null && typeof obj === 'object' && typeof obj.pipe === 'function'\n}\n\nfunction formatValue(input, skipEncoding) {\n  const {collectionFormat, allowEmptyValue} = input\n\n  // `input` can be string in OAS3 contexts\n  const value = typeof input === 'object' ? input.value : input\n\n  const SEPARATORS = {\n    csv: ',',\n    ssv: '%20',\n    tsv: '%09',\n    pipes: '|'\n  }\n\n  if (typeof value === 'undefined' && allowEmptyValue) {\n    return ''\n  }\n\n  if (isFile(value) || typeof value === 'boolean') {\n    return value\n  }\n\n  let encodeFn = encodeURIComponent\n  if (skipEncoding) {\n    if (isString(value)) encodeFn = str => str\n    else encodeFn = obj => JSON.stringify(obj)\n  }\n\n  if (typeof value === 'object' && !Array.isArray(value)) {\n    return ''\n  }\n\n  if (!Array.isArray(value)) {\n    return encodeFn(value)\n  }\n\n  if (Array.isArray(value) && !collectionFormat) {\n    return value.map(encodeFn).join(',')\n  }\n  if (collectionFormat === 'multi') {\n    return value.map(encodeFn)\n  }\n  return value.map(encodeFn)//.join(SEPARATORS[collectionFormat])\n}\n\n// Encodes an object using appropriate serializer.\nexport function encodeFormOrQuery(data) {\n  /**\n   * Encode parameter names and values\n   * @param {Object} result - parameter names and values\n   * @param {string} parameterName - Parameter name\n   * @return {object} encoded parameter names and values\n   */\n  const encodedQuery = Object.keys(data).reduce((result, parameterName) => {\n    const isObject = a => a && typeof a === 'object'\n    const paramValue = data[parameterName]\n    const skipEncoding = !!paramValue.skipEncoding\n    const encodedParameterName = skipEncoding ? parameterName : encodeURIComponent(parameterName)\n    const notArray = isObject(paramValue) && !Array.isArray(paramValue)\n    result[encodedParameterName] = formatValue(\n      notArray ? paramValue : {value: paramValue}, skipEncoding\n    )\n    return result\n  }, {})\n  return qs.stringify(encodedQuery, {encode: false, indices: false}) || ''\n}\n\n// If the request has a `query` object, merge it into the request.url, and delete the object\nexport function mergeInQueryOrForm(req = {}) {\n  const {url = '', query, form} = req\n\n  const joinSearch = (...strs) => {\n    const search = strs.filter(a => a).join('&') // Only truthy value\n    return search ? `?${search}` : '' // Only add '?' if there is a str\n  }\n\n  if (form) {\n    const hasFile = Object.keys(form).some((key) => {\n      return isFile(form[key].value)\n    })\n\n    const contentType = req.headers['content-type'] || req.headers['Content-Type']\n\n    if (hasFile || /multipart\\/form-data/i.test(contentType)) {\n      const FormData = require('isomorphic-form-data') // eslint-disable-line global-require\n      req.body = new FormData()\n      Object.keys(form).forEach((key) => {\n        const value = formatValue(form[key], true)\n        if (Array.isArray(value)) {\n          for (let i = 0; i < value.length; i++) {\n            req.body.append(key, value[i])\n          }\n        }\n        else {\n          req.body.append(key, value)\n        }\n      })\n    }\n    else {\n      req.body = encodeFormOrQuery(form)\n    }\n\n    delete (req.form)\n  }\n\n  if (query) {\n    const [baseUrl, oriSearch] = url.split('?')\n    let newStr = ''\n\n    if (oriSearch) {\n      const oriQuery = qs.parse(oriSearch)\n      const keysToRemove = Object.keys(query)\n      keysToRemove.forEach(key => delete oriQuery[key])\n      newStr = qs.stringify(oriQuery, {encode: true})\n    }\n\n    const finalStr = joinSearch(newStr, encodeFormOrQuery(query))\n    req.url = baseUrl + finalStr\n    delete (req.query)\n  }\n  return req\n}\n\n// Wrap a http function ( there are otherways to do this, conisder this deprecated )\nexport function makeHttp(httpFn, preFetch, postFetch) {\n  postFetch = postFetch || (a => a)\n  preFetch = preFetch || (a => a)\n\n  return (req) => {\n    if (typeof req === 'string') {\n      req = {url: req}\n    }\n    self.mergeInQueryOrForm(req)\n    req = preFetch(req)\n    return postFetch(httpFn(req))\n  }\n}\n","import jsonPatch from 'fast-json-patch'\nimport regenerator from '@babel/runtime-corejs2/regenerator'\nimport deepExtend from 'deep-extend'\nimport deepAssign from '@kyleshockey/object-assign-deep'\n\nexport default {\n  add,\n  replace,\n  remove,\n  merge,\n  mergeDeep,\n  context,\n  getIn,\n  applyPatch,\n  parentPathMatch,\n  flatten,\n  fullyNormalizeArray,\n  normalizeArray,\n  isPromise,\n  forEachNew,\n  forEachNewPrimitive,\n  isJsonPatch,\n  isContextPatch,\n  isPatch,\n  isMutation,\n  isAdditiveMutation,\n  isGenerator,\n  isFunction,\n  isObject,\n  isError\n}\n\nfunction applyPatch(obj, patch, opts) {\n  opts = opts || {}\n\n  patch = Object.assign({}, patch, {\n    path: patch.path && normalizeJSONPath(patch.path)\n  })\n\n  if (patch.op === 'merge') {\n    const newValue = getInByJsonPath(obj, patch.path)\n    Object.assign(newValue, patch.value)\n    jsonPatch.applyPatch(obj, [replace(patch.path, newValue)])\n  }\n  else if (patch.op === 'mergeDeep') {\n    const currentValue = getInByJsonPath(obj, patch.path)\n\n    // Iterate the properties of the patch\n    for (const prop in patch.value) {\n      const propVal = patch.value[prop]\n      const isArray = Array.isArray(propVal)\n      if (isArray) {\n        // deepExtend doesn't merge arrays, so we will do it manually\n        const existing = currentValue[prop] || []\n        currentValue[prop] = existing.concat(propVal)\n      }\n      else if (isObject(propVal) && !isArray) {\n        // If it's an object, iterate it's keys and merge\n        // if there are conflicting keys, merge deep, otherwise shallow merge\n        let currentObj = Object.assign({}, currentValue[prop])\n        for (const key in propVal) {\n          if (Object.prototype.hasOwnProperty.call(currentObj, key)) {\n            // if there is a single conflicting key, just deepExtend the entire value\n            // and break from the loop (since all future keys are also merged)\n            // We do this because we can't deepExtend two primitives\n            // (currentObj[key] & propVal[key] may be primitives).\n            //\n            // we also deeply assign here, since we aren't in control of\n            // how deepExtend affects existing nested objects\n            currentObj = deepExtend(deepAssign({}, currentObj), propVal)\n            break\n          }\n          else {\n            Object.assign(currentObj, {[key]: propVal[key]})\n          }\n        }\n        currentValue[prop] = currentObj\n      }\n      else {\n        // It's a primitive, just replace existing\n        currentValue[prop] = propVal\n      }\n    }\n  }\n  else if (patch.op === 'add' && patch.path === '' && isObject(patch.value)) {\n    // { op: 'add', path: '', value: { a: 1, b: 2 }}\n    // has no effect: json patch refuses to do anything.\n    // so let's break that patch down into a set of patches,\n    // one for each key in the intended root value.\n\n    const patches = Object.keys(patch.value)\n      .reduce((arr, key) => {\n        arr.push({\n          op: 'add',\n          path: `/${normalizeJSONPath(key)}`,\n          value: patch.value[key]\n        })\n        return arr\n      }, [])\n\n    jsonPatch.applyPatch(obj, patches)\n  }\n  else if (patch.op === 'replace' && patch.path === '') {\n    let value = patch.value\n\n    if (opts.allowMetaPatches && patch.meta && isAdditiveMutation(patch) &&\n        (Array.isArray(patch.value) || isObject(patch.value))) {\n      value = Object.assign({}, value, patch.meta)\n    }\n    obj = value\n  }\n  else {\n    jsonPatch.applyPatch(obj, [patch])\n\n    // Attach metadata to the resulting value.\n    if (opts.allowMetaPatches && patch.meta && isAdditiveMutation(patch) &&\n        (Array.isArray(patch.value) || isObject(patch.value))) {\n      const currentValue = getInByJsonPath(obj, patch.path)\n      const newValue = Object.assign({}, currentValue, patch.meta)\n      jsonPatch.applyPatch(obj, [replace(patch.path, newValue)])\n    }\n  }\n\n  return obj\n}\n\nfunction normalizeJSONPath(path) {\n  if (Array.isArray(path)) {\n    if (path.length < 1) {\n      return ''\n    }\n\n    return '/' + path.map((item) => { // eslint-disable-line prefer-template\n      return (item + '').replace(/~/g, '~0').replace(/\\//g, '~1') // eslint-disable-line prefer-template\n    }).join('/')\n  }\n\n  return path\n}\n\n\n// =========================\n// JSON-Patch Wrappers\n// =========================\n\nfunction add(path, value) {\n  return {op: 'add', path, value}\n}\n\nfunction _get(path) {\n  return {op: '_get', path}\n}\n\nfunction replace(path, value, meta) {\n  return {op: 'replace', path, value, meta}\n}\n\nfunction remove(path, value) {\n  return {op: 'remove', path}\n}\n\n// Custom wrappers\nfunction merge(path, value) {\n  return {type: 'mutation', op: 'merge', path, value}\n}\n\n// Custom wrappers\nfunction mergeDeep(path, value) {\n  return {type: 'mutation', op: 'mergeDeep', path, value}\n}\n\nfunction context(path, value) {\n  return {type: 'context', path, value}\n}\n\n\n// =========================\n// Iterators\n// =========================\n\nfunction forEachNew(mutations, fn) {\n  try {\n    return forEachNewPatch(mutations, forEach, fn)\n  }\n  catch (e) {\n    return e\n  }\n}\n\nfunction forEachNewPrimitive(mutations, fn) {\n  try {\n    return forEachNewPatch(mutations, forEachPrimitive, fn)\n  }\n  catch (e) {\n    return e\n  }\n}\n\nfunction forEachNewPatch(mutations, fn, callback) {\n  const res = mutations.filter(isAdditiveMutation).map((mutation) => {\n    return fn(mutation.value, callback, mutation.path)\n  }) || []\n  const flat = flatten(res)\n  const clean = cleanArray(flat)\n  return clean\n}\n\nfunction forEachPrimitive(obj, fn, basePath) {\n  basePath = basePath || []\n\n  if (Array.isArray(obj)) {\n    return obj.map((val, key) => {\n      return forEachPrimitive(val, fn, basePath.concat(key))\n    })\n  }\n\n  if (isObject(obj)) {\n    return Object.keys(obj).map((key) => {\n      return forEachPrimitive(obj[key], fn, basePath.concat(key))\n    })\n  }\n\n  return fn(obj, basePath[basePath.length - 1], basePath)\n}\n\nfunction forEach(obj, fn, basePath) {\n  basePath = basePath || []\n\n  let results = []\n  if (basePath.length > 0) {\n    const newResults = fn(obj, basePath[basePath.length - 1], basePath)\n    if (newResults) {\n      results = results.concat(newResults)\n    }\n  }\n\n  if (Array.isArray(obj)) {\n    const arrayResults = obj.map((val, key) => {\n      return forEach(val, fn, basePath.concat(key))\n    })\n    if (arrayResults) {\n      results = results.concat(arrayResults)\n    }\n  }\n  else if (isObject(obj)) {\n    const moreResults = Object.keys(obj).map((key) => {\n      return forEach(obj[key], fn, basePath.concat(key))\n    })\n    if (moreResults) {\n      results = results.concat(moreResults)\n    }\n  }\n\n  results = flatten(results)\n  return results\n}\n\n\n// =========================\n// Paths\n// =========================\n\nfunction parentPathMatch(path, arr) {\n  if (!Array.isArray(arr)) {\n    return false\n  }\n\n  for (let i = 0, len = arr.length; i < len; i++) {\n    if (arr[i] !== path[i]) {\n      return false\n    }\n  }\n\n  return true\n}\n\nfunction getIn(obj, path) {\n  return path.reduce((val, token) => {\n    if (typeof token !== 'undefined' && val) {\n      return val[token]\n    }\n    return val\n  }, obj)\n}\n\n// =========================\n// Array\n// =========================\n\nfunction fullyNormalizeArray(arr) {\n  return cleanArray(flatten(normalizeArray(arr)))\n}\n\nfunction normalizeArray(arr) {\n  return Array.isArray(arr) ? arr : [arr]\n}\n\nfunction flatten(arr) {\n  return [].concat(...arr.map((val) => {\n    return Array.isArray(val) ? flatten(val) : val\n  }))\n}\n\nfunction cleanArray(arr) {\n  return arr.filter(elm => typeof elm !== 'undefined')\n}\n\n\n// =========================\n// Is-Thing.\n// =========================\n\nfunction isObject(val) {\n  return val && typeof val === 'object'\n}\n\nfunction isPromise(val) {\n  return isObject(val) && isFunction(val.then)\n}\n\nfunction isFunction(val) {\n  return val && typeof val === 'function'\n}\n\nfunction isError(patch) {\n  return patch instanceof Error\n}\n\nfunction isJsonPatch(patch) {\n  if (isPatch(patch)) {\n    const op = patch.op\n    return op === 'add' || op === 'remove' || op === 'replace'\n  }\n  return false\n}\n\nfunction isGenerator(thing) {\n  return regenerator.isGeneratorFunction(thing)\n}\n\nfunction isMutation(patch) {\n  return isJsonPatch(patch) || (isPatch(patch) && patch.type === 'mutation')\n}\n\nfunction isAdditiveMutation(patch) {\n  return isMutation(patch) && (patch.op === 'add' || patch.op === 'replace' || patch.op === 'merge' || patch.op === 'mergeDeep')\n}\n\nfunction isContextPatch(patch) {\n  return isPatch(patch) && patch.type === 'context'\n}\n\nfunction isPatch(patch) {\n  return patch && typeof patch === 'object'\n}\n\nfunction getInByJsonPath(obj, jsonPath) {\n  try {\n    return jsonPatch.getValueByPointer(obj, jsonPath)\n  }\n  catch (e) {\n    console.error(e) // eslint-disable-line no-console\n    return {}\n  }\n}\n","export default function createErrorType(name, init) {\n  function E(...args) {\n    if (!Error.captureStackTrace) {\n      this.stack = (new Error()).stack\n    }\n    else {\n      Error.captureStackTrace(this, this.constructor)\n    }\n    this.message = args[0]\n    init && init.apply(this, args)\n  }\n\n  E.prototype = new Error()\n  E.prototype.name = name\n  E.prototype.constructor = E\n\n  return E\n}\n","import traverse from 'traverse'\nimport URL from 'url'\n\n// This will match if the direct parent's key exactly matches an item.\nconst freelyNamedKeyParents = [\n  'properties',\n]\n\n// This will match if the grandparent's key exactly matches an item.\n// NOTE that this is for finding non-free paths!\nconst nonFreelyNamedKeyGrandparents = [\n  'properties',\n]\n\n// This will match if the joined parent path exactly matches an item.\n//\n// This is mostly useful for filtering out root-level reusable item names,\n// for example `[\"definitions\", \"$ref\"]`\nconst freelyNamedPaths = [\n  // Swagger 2.0\n  'definitions',\n  'parameters',\n  'responses',\n  'securityDefinitions',\n\n  // OpenAPI 3.0\n  'components/schemas',\n  'components/responses',\n  'components/parameters',\n  'components/securitySchemes'\n]\n\n// This will match if any of these items are substrings of the joined\n// parent path.\n//\n// Warning! These are powerful. Beware of edge cases.\nconst freelyNamedAncestors = [\n  'schema/example',\n  'items/example',\n]\n\nexport function isFreelyNamed(parentPath) {\n  const parentKey = parentPath[parentPath.length - 1]\n  const grandparentKey = parentPath[parentPath.length - 2]\n  const parentStr = parentPath.join('/')\n\n  return (\n    // eslint-disable-next-line max-len\n    (freelyNamedKeyParents.indexOf(parentKey) > -1 && nonFreelyNamedKeyGrandparents.indexOf(grandparentKey) === -1) ||\n    (freelyNamedPaths.indexOf(parentStr) > -1) ||\n    (freelyNamedAncestors.some(el => parentStr.indexOf(el) > -1))\n  )\n}\n\nexport function generateAbsoluteRefPatches(obj, basePath, {\n  specmap,\n  getBaseUrlForNodePath = path => specmap.getContext([...basePath, ...path]).baseDoc,\n  targetKeys = ['$ref', '$$ref']\n} = {}) {\n  const patches = []\n\n  traverse(obj).forEach(function () {\n    if (targetKeys.indexOf(this.key) > -1) {\n      const nodePath = this.path // this node's path, relative to `obj`\n      const fullPath = basePath.concat(this.path)\n\n      const absolutifiedRefValue = absolutifyPointer(this.node, getBaseUrlForNodePath(nodePath))\n\n      patches.push(specmap.replace(fullPath, absolutifiedRefValue))\n    }\n  })\n\n  return patches\n}\n\nexport function absolutifyPointer(pointer, baseUrl) {\n  const [urlPart, fragmentPart] = pointer.split('#')\n  const newRefUrlPart = URL.resolve(urlPart || '', baseUrl || '')\n\n  return fragmentPart ? `${newRefUrlPart}#${fragmentPart}` : newRefUrlPart\n}\n","export const ACCEPT_HEADER_VALUE_FOR_DOCUMENTS = 'application/json, application/yaml'\n","import {fetch} from 'cross-fetch'\nimport jsYaml from 'js-yaml'\nimport qs from 'querystring-browser'\nimport url from 'url'\nimport lib from '../lib'\nimport createError from '../lib/create-error'\nimport {isFreelyNamed, absolutifyPointer} from '../helpers'\nimport {ACCEPT_HEADER_VALUE_FOR_DOCUMENTS} from '../../constants'\n\nconst ABSOLUTE_URL_REGEXP = new RegExp('^([a-z]+://|//)', 'i')\n\nconst JSONRefError = createError('JSONRefError', function (message, extra, oriError) {\n  this.originalError = oriError\n  Object.assign(this, extra || {})\n})\n\nconst docCache = {}\nconst specmapRefs = new WeakMap()\n\nconst skipResolutionTestFns = [\n  path => (\n    // OpenAPI 3.0 Response Media Type Example\n    // [\"paths\", *, *, \"responses\", *, \"content\", *, \"example\"]\n    path[0] === 'paths'\n    && path[3] === 'responses'\n    && path[5] === 'content'\n    && path[7] === 'example'\n  ),\n  path => (\n    // OpenAPI 3.0 Request Body Media Type Example\n    // [\"paths\", *, *, \"responses\", *, \"content\", *, \"example\"]\n    path[0] === 'paths'\n    && path[3] === 'requestBody'\n    && path[4] === 'content'\n    && path[6] === 'example'\n  )\n]\n\nconst shouldSkipResolution = path => skipResolutionTestFns.some(fn => fn(path))\n\n// =========================\n// Core\n// =========================\n\n/**\n * This plugin resolves the JSON pointers.\n * A major part of this plugin deals with cyclic references via 2 mechanisms.\n * 1. If a pointer was already resolved before in this path, halt.\n * 2. If the patch value points to one of the ancestors in this path, halt.\n *\n * Note that either one of these mechanism is sufficient, both must be in place.\n * For examples:\n *\n * Given the following spec, #1 alone is insufficient because after the 2nd\n * application, there will be a cyclic object reference.\n *   a.b.c: $ref-d\n *   d.e.f: $ref-a (per #1, safe to return patch as no immediate cycle)\n *\n * Given the following spec, #2 alone is insufficient because although there will\n * never be any cyclic object reference, the plugin will keep producing patches.\n *   a: $ref-b\n *   b: $ref-a\n */\nconst plugin = {\n  key: '$ref',\n  plugin: (ref, key, fullPath, specmap) => {\n    const specmapInstance = specmap.getInstance()\n    const parent = fullPath.slice(0, -1)\n\n    if (isFreelyNamed(parent) || shouldSkipResolution(parent)) {\n      return\n    }\n\n    const baseDoc = specmap.getContext(fullPath).baseDoc\n    if (typeof ref !== 'string') {\n      return new JSONRefError('$ref: must be a string (JSON-Ref)', {\n        $ref: ref,\n        baseDoc,\n        fullPath,\n      })\n    }\n\n    const splitString = split(ref)\n    const refPath = splitString[0]\n    const pointer = splitString[1] || ''\n\n    let basePath\n    try {\n      basePath = (baseDoc || refPath) ? absoluteify(refPath, baseDoc) : null\n    }\n    catch (e) {\n      return wrapError(e, {\n        pointer,\n        $ref: ref,\n        basePath,\n        fullPath,\n      })\n    }\n\n    let promOrVal\n    let tokens\n\n    if (pointerAlreadyInPath(pointer, basePath, parent, specmap)) {\n      // Cyclic reference!\n      // if `useCircularStructures` is not set, just leave the reference\n      // unresolved, but absolutify it so that we don't leave an invalid $ref\n      // path in the content\n      if (!specmapInstance.useCircularStructures) {\n        const absolutifiedRef = absolutifyPointer(ref, basePath)\n\n        if (ref === absolutifiedRef) {\n          // avoids endless looping\n          // without this, the ref plugin never stops seeing this $ref\n          return null\n        }\n        return lib.replace(fullPath, absolutifiedRef)\n      }\n    }\n\n    if (basePath == null) {\n      tokens = jsonPointerToArray(pointer)\n      promOrVal = specmap.get(tokens)\n\n      if (typeof promOrVal === 'undefined') {\n        promOrVal = new JSONRefError(`Could not resolve reference: ${ref}`, {\n          pointer,\n          $ref: ref,\n          baseDoc,\n          fullPath,\n        })\n      }\n    }\n    else {\n      promOrVal = extractFromDoc(basePath, pointer)\n      if (promOrVal.__value != null) {\n        promOrVal = promOrVal.__value\n      }\n      else {\n        promOrVal = promOrVal.catch((e) => {\n          throw wrapError(e, {\n            pointer,\n            $ref: ref,\n            baseDoc,\n            fullPath,\n          })\n        })\n      }\n    }\n\n    if (promOrVal instanceof Error) {\n      return [lib.remove(fullPath), promOrVal]\n    }\n\n    const absolutifiedRef = absolutifyPointer(ref, basePath)\n\n    const patch = lib.replace(parent, promOrVal, {$$ref: absolutifiedRef})\n    if (basePath && basePath !== baseDoc) {\n      return [patch, lib.context(parent, {baseDoc: basePath})]\n    }\n\n    try {\n      // prevents circular values from being constructed, unless we specifically\n      // want that to happen\n      if (!patchValueAlreadyInPath(specmap.state, patch) || specmapInstance.useCircularStructures) {\n        return patch\n      }\n    }\n    catch (e) {\n      // if we're catching here, path traversal failed, so we should\n      // ditch without sending any patches back up.\n      //\n      // this is a narrow fix for the larger problem of patches being queued\n      // and then having the state they were generated against be modified\n      // before they are applied.\n      //\n      // TODO: re-engineer specmap patch/state management to avoid this\n      return null\n    }\n  }\n}\n\n\nconst mod = Object.assign(plugin, {\n  docCache,\n  absoluteify,\n  clearCache,\n  JSONRefError,\n  wrapError,\n  getDoc,\n  split,\n  extractFromDoc,\n  fetchJSON,\n  extract,\n  jsonPointerToArray,\n  unescapeJsonPointerToken\n})\n\nexport default mod\n\n\n// =========================\n// Utilities\n// =========================\n\n/**\n * Resolves a path and its base to an abolute URL.\n * @api public\n */\nfunction absoluteify(path, basePath) {\n  if (!ABSOLUTE_URL_REGEXP.test(path)) {\n    if (!basePath) {\n      throw new JSONRefError(`Tried to resolve a relative URL, without having a basePath. path: '${path}' basePath: '${basePath}'`)\n    }\n    return url.resolve(basePath, path)\n  }\n  return path\n}\n\n/**\n * Wraps an error as JSONRefError.\n * @param  {Error} e      the error.\n * @param  {Object} extra (optional) optional data.\n * @return {Error}        an instance of JSONRefError.\n * @api public\n */\nfunction wrapError(e, extra) {\n  let message\n\n  if (e && e.response && e.response.body) {\n    message = `${e.response.body.code} ${e.response.body.message}`\n  }\n  else {\n    message = e.message\n  }\n\n  return new JSONRefError(`Could not resolve reference: ${message}`, extra, e)\n}\n\n/**\n * Splits a pointer by the hash delimiter.\n * @api public\n */\nfunction split(ref) {\n  return (ref + '').split('#') // eslint-disable-line prefer-template\n}\n\n/**\n * Extracts a pointer from its document.\n * @param  {String} docPath the absolute document URL.\n * @param  {String} pointer the pointer whose value is to be extracted.\n * @return {Promise}        a promise of the pointer value.\n * @api public\n */\nfunction extractFromDoc(docPath, pointer) {\n  const doc = docCache[docPath]\n  if (doc && !lib.isPromise(doc)) {\n    // If doc is already available, return __value together with the promise.\n    // __value is for special handling in cycle check:\n    // pointerAlreadyInPath() won't work if patch.value is a promise,\n    // thus when that promise is finally resolved, cycle might happen (because\n    // `spec` and `docCache[basePath]` refer to the exact same object).\n    // See test \"should resolve a cyclic spec when baseDoc is specified\".\n    try {\n      const v = extract(pointer, doc)\n      return Object.assign(Promise.resolve(v), {__value: v})\n    }\n    catch (e) {\n      return Promise.reject(e)\n    }\n  }\n\n  return getDoc(docPath).then(_doc => extract(pointer, _doc))\n}\n\n/**\n * Clears all document caches.\n * @param  {String} item (optional) the name of the cache item to be cleared.\n * @api public\n */\nfunction clearCache(item) {\n  if (typeof item !== 'undefined') {\n    delete docCache[item]\n  }\n  else {\n    Object.keys(docCache).forEach((key) => {\n      delete docCache[key]\n    })\n  }\n}\n\n/**\n * Fetches and caches a document.\n * @param  {String} docPath the absolute URL of the document.\n * @return {Promise}        a promise of the document content.\n * @api public\n */\nfunction getDoc(docPath) {\n  const val = docCache[docPath]\n  if (val) {\n    return lib.isPromise(val) ? val : Promise.resolve(val)\n  }\n\n  // NOTE: we need to use `mod.fetchJSON` in order to be able to overwrite it.\n  // Any tips on how to make this cleaner, please ping!\n  docCache[docPath] = mod.fetchJSON(docPath).then((doc) => {\n    docCache[docPath] = doc\n    return doc\n  })\n  return docCache[docPath]\n}\n\n/**\n * Fetches a document.\n * @param  {String} docPath the absolute URL of the document.\n * @return {Promise}        a promise of the document content.\n * @api public\n */\nfunction fetchJSON(docPath) {\n  return fetch(docPath, {headers: {Accept: ACCEPT_HEADER_VALUE_FOR_DOCUMENTS}, loadSpec: true})\n    .then(res => res.text())\n    .then(text => jsYaml.safeLoad(text))\n}\n\n/**\n * Extracts a pointer from an object.\n * @param  {String[]} pointer the JSON pointer.\n * @param  {Object} obj       an object whose value is to be extracted.\n * @return {Object}           the value to be extracted.\n * @api public\n */\nfunction extract(pointer, obj) {\n  const tokens = jsonPointerToArray(pointer)\n  if (tokens.length < 1) {\n    return obj\n  }\n\n  const val = lib.getIn(obj, tokens)\n  if (typeof val === 'undefined') {\n    throw new JSONRefError(`Could not resolve pointer: ${pointer} does not exist in document`, {pointer})\n  }\n  return val\n}\n\n/**\n * Converts a JSON pointer to array.\n * @api public\n */\nfunction jsonPointerToArray(pointer) {\n  if (typeof pointer !== 'string') {\n    throw new TypeError(`Expected a string, got a ${typeof pointer}`)\n  }\n\n  if (pointer[0] === '/') {\n    pointer = pointer.substr(1)\n  }\n\n  if (pointer === '') {\n    return []\n  }\n\n  return pointer.split('/').map(unescapeJsonPointerToken)\n}\n\n/**\n * Unescapes a JSON pointer.\n * @api public\n */\nfunction unescapeJsonPointerToken(token) {\n  if (typeof token !== 'string') {\n    return token\n  }\n  return qs.unescape(token.replace(/~1/g, '/').replace(/~0/g, '~'))\n}\n\n/**\n * Escapes a JSON pointer.\n * @api public\n */\nfunction escapeJsonPointerToken(token) {\n  return qs.escape(token.replace(/~/g, '~0').replace(/\\//g, '~1'))\n}\n\nfunction arrayToJsonPointer(arr) {\n  if (arr.length === 0) {\n    return ''\n  }\n\n  return `/${arr.map(escapeJsonPointerToken).join('/')}`\n}\n\nconst pointerBoundaryChar = c => !c || c === '/' || c === '#'\n\nfunction pointerIsAParent(pointer, parentPointer) {\n  if (pointerBoundaryChar(parentPointer)) {\n    // This is the root of the document, so its naturally a parent\n    return true\n  }\n  const nextChar = pointer.charAt(parentPointer.length)\n  const lastParentChar = parentPointer.slice(-1)\n\n  return pointer.indexOf(parentPointer) === 0\n    && (!nextChar || nextChar === '/' || nextChar === '#')\n    && lastParentChar !== '#'\n}\n\n\n// =========================\n// Private\n// =========================\n\n/**\n * Checks if this pointer points back to one or more pointers along the path.\n */\nfunction pointerAlreadyInPath(pointer, basePath, parent, specmap) {\n  let refs = specmapRefs.get(specmap)\n  if (!refs) {\n    // Stores all resolved references of a specmap instance.\n    // Schema: path -> pointer (path's $ref value).\n    refs = {}\n    specmapRefs.set(specmap, refs)\n  }\n\n  const parentPointer = arrayToJsonPointer(parent)\n  const fullyQualifiedPointer = `${basePath || '<specmap-base>'}#${pointer}`\n\n  // dirty hack to strip `allof/[index]` from the path, in order to avoid cases\n  // where we get false negatives because:\n  // - we resolve a path, then\n  // - allOf plugin collapsed `allOf/[index]` out of the path, then\n  // - we try to work on a child $ref within that collapsed path.\n  //\n  // because of the path collapse, we lose track of it in our specmapRefs hash\n  // solution: always throw the allOf constructs out of paths we store\n  // TODO: solve this with a global register, or by writing more metadata in\n  // either allOf or refs plugin\n  const safeParentPointer = parentPointer.replace(/allOf\\/\\d+\\/?/g, '')\n\n  // Case 1: direct cycle, e.g. a.b.c.$ref: '/a.b'\n  // Detect by checking that the parent path doesn't start with pointer.\n  // This only applies if the pointer is internal, i.e. basePath === rootPath (could be null)\n  const rootDoc = specmap.contextTree.get([]).baseDoc\n  if (basePath == rootDoc && pointerIsAParent(safeParentPointer, pointer)) { // eslint-disable-line\n    return true\n  }\n\n\n  // Case 2: indirect cycle\n  //  ex1: a.$ref: '/b'  &  b.c.$ref: '/b/c'\n  //  ex2: a.$ref: '/b/c'  &  b.c.$ref: '/b'\n  // Detect by retrieving all the $refs along the path of parent\n  // and checking if any starts with pointer or vice versa.\n  let currPath = ''\n  const hasIndirectCycle = parent.some((token) => {\n    currPath = `${currPath}/${escapeJsonPointerToken(token)}`\n    return refs[currPath] && refs[currPath].some((ref) => {\n      return (\n           pointerIsAParent(ref, fullyQualifiedPointer)\n        || pointerIsAParent(fullyQualifiedPointer, ref)\n      )\n    })\n  })\n  if (hasIndirectCycle) {\n    return true\n  }\n\n  // No cycle, this ref will be resolved, so stores it now for future detection.\n  // No need to store if has cycle, as parent path is a dead-end and won't be checked again.\n\n  refs[safeParentPointer] = (refs[safeParentPointer] || []).concat(fullyQualifiedPointer)\n}\n\n/**\n * Checks if the value of this patch ends up pointing to an ancestor along the path.\n */\nfunction patchValueAlreadyInPath(root, patch) {\n  const ancestors = [root]\n  patch.path.reduce((parent, p) => {\n    ancestors.push(parent[p])\n    return parent[p]\n  }, root)\n  return pointToAncestor(patch.value)\n\n  function pointToAncestor(obj) {\n    return lib.isObject(obj) && (ancestors.indexOf(obj) >= 0 || Object.keys(obj).some((k) => {\n      return pointToAncestor(obj[k])\n    }))\n  }\n}\n","import {isFreelyNamed, generateAbsoluteRefPatches} from '../helpers'\n\nexport default {\n  key: 'allOf',\n  plugin: (val, key, fullPath, specmap, patch) => {\n    // Ignore replace patches created by $ref because the changes will\n    // occur in the original \"add\" patch and we don't want this plugin\n    // to redundantly processes those \"relace\" patches.\n    if (patch.meta && patch.meta.$$ref) {\n      return\n    }\n\n    const parent = fullPath.slice(0, -1)\n    if (isFreelyNamed(parent)) {\n      return\n    }\n\n    if (!Array.isArray(val)) {\n      const err = new TypeError('allOf must be an array')\n      err.fullPath = fullPath // This is an array\n      return err\n    }\n\n\n    let alreadyAddError = false\n\n    // Find the original definition from the `patch.value` object\n    // Remove the `allOf` property so it doesn't get added to the result of the `allOf` plugin\n    let originalDefinitionObj = patch.value\n    parent.forEach((part) => {\n      if (!originalDefinitionObj) return // bail out if we've lost sight of our target\n      originalDefinitionObj = originalDefinitionObj[part]\n    })\n    originalDefinitionObj = Object.assign({}, originalDefinitionObj)\n    delete originalDefinitionObj.allOf\n\n    const patches = []\n\n    // remove existing content\n    patches.push(specmap.replace(parent, {}))\n\n    val.forEach((toMerge, i) => {\n      if (!specmap.isObject(toMerge)) {\n        if (alreadyAddError) {\n          return null\n        }\n        alreadyAddError = true\n\n        const err = new TypeError('Elements in allOf must be objects')\n        err.fullPath = fullPath // This is an array\n        return patches.push(err)\n      }\n\n      // Deeply merge the member's contents onto the parent location\n      patches.push(specmap.mergeDeep(parent, toMerge))\n\n      // Generate patches that migrate $ref values based on ContextTree information\n\n      // remove [\"allOf\"], which will not be present when these patches are applied\n      const collapsedFullPath = fullPath.slice(0, -1)\n\n      const absoluteRefPatches = generateAbsoluteRefPatches(toMerge, collapsedFullPath, {\n        getBaseUrlForNodePath: (nodePath) => {\n          return specmap.getContext([...fullPath, i, ...nodePath]).baseDoc\n        },\n        specmap\n      })\n\n      patches.push(...absoluteRefPatches)\n    })\n\n    // Merge back the values from the original definition\n    patches.push(specmap.mergeDeep(parent, originalDefinitionObj))\n\n    // If there was not an original $$ref value, make sure to remove\n    // any $$ref value that may exist from the result of `allOf` merges\n    if (!originalDefinitionObj.$$ref) {\n      patches.push(specmap.remove([].concat(parent, '$$ref')))\n    }\n\n    return patches\n  }\n}\n","import lib from '../lib'\n\nexport default {\n  key: 'parameters',\n  plugin: (parameters, key, fullPath, specmap, patch) => {\n    if (Array.isArray(parameters) && parameters.length) {\n      const val = Object.assign([], parameters)\n      const opPath = fullPath.slice(0, -1)\n      const op = Object.assign({}, lib.getIn(specmap.spec, opPath))\n\n      parameters.forEach((param, i) => {\n        try {\n          val[i].default = specmap.parameterMacro(op, param)\n        }\n        catch (e) {\n          const err = new Error(e)\n          err.fullPath = fullPath\n          return err\n        }\n      })\n\n      return lib.replace(fullPath, val)\n    }\n\n    return lib.replace(fullPath, parameters)\n  }\n}\n","import lib from '../lib'\n\nexport default {\n  key: 'properties',\n  plugin: (properties, key, fullPath, specmap) => {\n    const val = Object.assign({}, properties)\n\n    for (const k in properties) {\n      try {\n        val[k].default = specmap.modelPropertyMacro(val[k])\n      }\n      catch (e) {\n        const err = new Error(e)\n        err.fullPath = fullPath // This is an array\n        return err\n      }\n    }\n\n    const patch = lib.replace(fullPath, val)\n\n    return patch\n  }\n}\n","export default class ContextTree {\n  constructor(value) {\n    this.root = createNode(value || {})\n  }\n\n  set(path, value) {\n    const parent = this.getParent(path, true)\n    if (!parent) {\n      updateNode(this.root, value, null)\n      return\n    }\n\n    const key = path[path.length - 1]\n    const children = parent.children\n    if (children[key]) {\n      updateNode(children[key], value, parent)\n      return\n    }\n\n    children[key] = createNode(value, parent)\n  }\n\n  // Get the \"best\" node (node or nearest parent) and return its value.\n  get(path) {\n    path = path || []\n\n    if (path.length < 1) {\n      return this.root.value\n    }\n\n    let branch = this.root\n    let child\n    let token\n    for (let i = 0; i < path.length; i++) {\n      token = path[i]\n      child = branch.children\n      if (!child[token]) {\n        break\n      }\n      branch = child[token]\n    }\n\n    return branch && branch.protoValue\n  }\n\n  getParent(path, ensureExists) {\n    if (!path || path.length < 1) {\n      return null\n    }\n\n    if (path.length < 2) {\n      return this.root\n    }\n\n    return path.slice(0, -1).reduce((branch, token) => {\n      if (!branch) {\n        return branch\n      }\n\n      const children = branch.children\n\n      if (!children[token] && ensureExists) {\n        children[token] = createNode(null, branch)\n      }\n\n      return children[token]\n    }, this.root)\n  }\n}\n\n// =========================\n// Utilities\n// =========================\n\nfunction createNode(value, parent) {\n  return updateNode({children: {}}, value, parent)\n}\n\nfunction updateNode(node, value, parent) {\n  node.value = value || {}\n  node.protoValue = parent\n    ? {...parent.protoValue, ...node.value}\n    : node.value\n\n  Object.keys(node.children).forEach((prop) => {\n    const child = node.children[prop]\n    node.children[prop] = updateNode(child, child.value, node)\n  })\n\n  return node\n}\n","import find from 'lodash/find'\n\nimport lib from './lib'\nimport refs from './lib/refs'\nimport allOf from './lib/all-of'\nimport parameters from './lib/parameters'\nimport properties from './lib/properties'\nimport ContextTree from './lib/context-tree'\n\nconst HARD_LIMIT = 100\n\nclass SpecMap {\n  constructor(opts) {\n    Object.assign(this, {\n      spec: '',\n      debugLevel: 'info',\n      plugins: [],\n      pluginHistory: {},\n      errors: [],\n      mutations: [],\n      promisedPatches: [],\n      state: {},\n      patches: [],\n      context: {},\n      contextTree: new ContextTree(),\n      showDebug: false,\n      allPatches: [], // only populated if showDebug is true\n      pluginProp: 'specMap',\n      libMethods: Object.assign(Object.create(this), lib, {\n        getInstance: () => this\n      }),\n      allowMetaPatches: false,\n    }, opts)\n\n    // Lib methods bound\n    this.get = this._get.bind(this)\n    this.getContext = this._getContext.bind(this)\n    this.hasRun = this._hasRun.bind(this)\n\n    this.wrappedPlugins = this.plugins\n      .map(this.wrapPlugin.bind(this))\n      .filter(lib.isFunction)\n\n    // Initial patch(s)\n    this.patches.push(lib.add([], this.spec))\n    this.patches.push(lib.context([], this.context))\n    this.updatePatches(this.patches)\n  }\n\n  debug(level, ...args) {\n    if (this.debugLevel === level) {\n      console.log(...args) // eslint-disable-line no-console\n    }\n  }\n\n  verbose(header, ...args) {\n    if (this.debugLevel === 'verbose') {\n      console.log(`[${header}]   `, ...args) // eslint-disable-line no-console\n    }\n  }\n\n  wrapPlugin(plugin, name) {\n    const pathDiscriminator = this.pathDiscriminator\n    let ctx = null\n    let fn\n\n    if (plugin[this.pluginProp]) {\n      ctx = plugin\n      fn = plugin[this.pluginProp]\n    }\n    else if (lib.isFunction(plugin)) {\n      fn = plugin\n    }\n    else if (lib.isObject(plugin)) {\n      fn = createKeyBasedPlugin(plugin)\n    }\n\n    return Object.assign(fn.bind(ctx), {\n      pluginName: plugin.name || name,\n      isGenerator: lib.isGenerator(fn)\n    })\n\n    // Expected plugin interface: {key: string, plugin: fn*}\n    // This traverses depth-first and immediately applies yielded patches.\n    // This strategy should work well for most plugins (including the built-ins).\n    // We might consider making this (traversing & application) configurable later.\n    function createKeyBasedPlugin(pluginObj) {\n      const isSubPath = (path, tested) => {\n        if (!Array.isArray(path)) {\n          return true\n        }\n\n        return path.every((val, i) => {\n          return val === tested[i]\n        })\n      }\n\n      return function* (patches, specmap) {\n        const refCache = {}\n\n        for (const patch of patches.filter(lib.isAdditiveMutation)) {\n          yield* traverse(patch.value, patch.path, patch)\n        }\n\n        function* traverse(obj, path, patch) {\n          if (!lib.isObject(obj)) {\n            if (pluginObj.key === path[path.length - 1]) {\n              yield pluginObj.plugin(obj, pluginObj.key, path, specmap)\n            }\n          }\n          else {\n            const parentIndex = path.length - 1\n            const parent = path[parentIndex]\n            const indexOfFirstProperties = path.indexOf('properties')\n            const isRootProperties = parent === 'properties' && parentIndex === indexOfFirstProperties\n            const traversed = specmap.allowMetaPatches && refCache[obj.$$ref]\n\n            for (const key of Object.keys(obj)) {\n              const val = obj[key]\n              const updatedPath = path.concat(key)\n              const isObj = lib.isObject(val)\n              const objRef = obj.$$ref\n\n              if (!traversed) {\n                if (isObj) {\n                  // Only store the ref if it exists\n                  if (specmap.allowMetaPatches && objRef) {\n                    refCache[objRef] = true\n                  }\n                  yield* traverse(val, updatedPath, patch)\n                }\n              }\n\n              if (!isRootProperties && key === pluginObj.key) {\n                const isWithinPathDiscriminator = isSubPath(pathDiscriminator, path)\n                if (!pathDiscriminator || isWithinPathDiscriminator) {\n                  yield pluginObj.plugin(val, key, updatedPath, specmap, patch)\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  nextPlugin() {\n    // Array.prototype.find doesn't work in IE 11 :(\n    return find(this.wrappedPlugins, (plugin) => {\n      const mutations = this.getMutationsForPlugin(plugin)\n      return mutations.length > 0\n    })\n  }\n\n  nextPromisedPatch() {\n    if (this.promisedPatches.length > 0) {\n      return Promise.race(this.promisedPatches.map(patch => patch.value))\n    }\n  }\n\n  getPluginHistory(plugin) {\n    const name = this.getPluginName(plugin)\n    return this.pluginHistory[name] || []\n  }\n\n  getPluginRunCount(plugin) {\n    return this.getPluginHistory(plugin).length\n  }\n\n  getPluginHistoryTip(plugin) {\n    const history = this.getPluginHistory(plugin)\n    const val = history && history[history.length - 1]\n    return val || {}\n  }\n\n  getPluginMutationIndex(plugin) {\n    const mi = this.getPluginHistoryTip(plugin).mutationIndex\n    return typeof mi !== 'number' ? -1 : mi\n  }\n\n  getPluginName(plugin) {\n    return plugin.pluginName\n  }\n\n  updatePluginHistory(plugin, val) {\n    const name = this.getPluginName(plugin)\n    const history = this.pluginHistory[name] = this.pluginHistory[name] || []\n    history.push(val)\n  }\n\n  updatePatches(patches, plugin) {\n    lib.normalizeArray(patches).forEach((patch) => {\n      if (patch instanceof Error) {\n        this.errors.push(patch)\n        return\n      }\n\n      try {\n        if (!lib.isObject(patch)) {\n          this.debug('updatePatches', 'Got a non-object patch', patch)\n          return\n        }\n\n        if (this.showDebug) {\n          this.allPatches.push(patch)\n        }\n\n        if (lib.isPromise(patch.value)) {\n          this.promisedPatches.push(patch)\n          this.promisedPatchThen(patch)\n          return\n        }\n\n        if (lib.isContextPatch(patch)) {\n          this.setContext(patch.path, patch.value)\n          return\n        }\n\n        if (lib.isMutation(patch)) {\n          this.updateMutations(patch)\n          return\n        }\n      }\n      catch (e) {\n        console.error(e) // eslint-disable-line no-console\n        this.errors.push(e)\n      }\n    })\n  }\n\n  updateMutations(patch) {\n    if (typeof patch.value === 'object' && !Array.isArray(patch.value) && this.allowMetaPatches) {\n      patch.value = Object.assign({}, patch.value)\n    }\n\n    const result = lib.applyPatch(this.state, patch, {allowMetaPatches: this.allowMetaPatches})\n    if (result) {\n      this.mutations.push(patch)\n      this.state = result\n    }\n  }\n\n  removePromisedPatch(patch) {\n    const index = this.promisedPatches.indexOf(patch)\n    if (index < 0) {\n      this.debug('Tried to remove a promisedPatch that isn\\'t there!')\n      return\n    }\n    this.promisedPatches.splice(index, 1)\n  }\n\n  promisedPatchThen(patch) {\n    const value = patch.value = patch.value\n      .then((val) => {\n        const promisedPatch = Object.assign({}, patch, {value: val})\n        this.removePromisedPatch(patch)\n        this.updatePatches(promisedPatch)\n      })\n      .catch((e) => {\n        this.removePromisedPatch(patch)\n        this.updatePatches(e)\n      })\n    return value\n  }\n\n  getMutations(from, to) {\n    from = from || 0\n    if (typeof to !== 'number') {\n      to = this.mutations.length\n    }\n    return this.mutations.slice(from, to)\n  }\n\n  getCurrentMutations() {\n    return this.getMutationsForPlugin(this.getCurrentPlugin())\n  }\n\n  getMutationsForPlugin(plugin) {\n    const tip = this.getPluginMutationIndex(plugin)\n    return this.getMutations(tip + 1)\n  }\n\n  getCurrentPlugin() {\n    return this.currentPlugin\n  }\n\n  getPatchesOfType(patches, fn) {\n    return patches.filter(fn)\n  }\n\n  getLib() {\n    return this.libMethods\n  }\n\n  _get(path) {\n    return lib.getIn(this.state, path)\n  }\n\n  _getContext(path) {\n    return this.contextTree.get(path)\n  }\n\n  setContext(path, value) {\n    return this.contextTree.set(path, value)\n  }\n\n  _hasRun(count) {\n    const times = this.getPluginRunCount(this.getCurrentPlugin())\n    return times > (count || 0)\n  }\n\n  _clone(obj) {\n    // For debugging only\n    return JSON.parse(JSON.stringify(obj))\n  }\n\n  dispatch() {\n    const that = this\n    const plugin = this.nextPlugin()\n\n    if (!plugin) {\n      const nextPromise = this.nextPromisedPatch()\n      if (nextPromise) {\n        return nextPromise\n          .then(() => this.dispatch())\n          .catch(() => this.dispatch())\n      }\n\n      // We're done!\n      const result = {spec: this.state, errors: this.errors}\n      if (this.showDebug) {\n        result.patches = this.allPatches\n      }\n      return Promise.resolve(result)\n    }\n\n    // Makes sure plugin isn't running an endless loop\n    that.pluginCount = that.pluginCount || {}\n    that.pluginCount[plugin] = (that.pluginCount[plugin] || 0) + 1\n    if (that.pluginCount[plugin] > HARD_LIMIT) {\n      return Promise.resolve({\n        spec: that.state,\n        errors: that.errors.concat(new Error(`We've reached a hard limit of ${HARD_LIMIT} plugin runs`))\n      })\n    }\n\n    // A different plugin runs, wait for all promises to resolve, then retry\n    if (plugin !== this.currentPlugin && this.promisedPatches.length) {\n      const promises = this.promisedPatches.map(p => p.value)\n\n      // Waits for all to settle instead of Promise.all which stops on rejection\n      return Promise.all(promises.map((promise) => {\n        return promise.then(Function, Function)\n      })).then(() => this.dispatch())\n    }\n\n    // Ok, run the plugin\n    return executePlugin()\n\n    function executePlugin() {\n      that.currentPlugin = plugin\n      const mutations = that.getCurrentMutations()\n      const lastMutationIndex = that.mutations.length - 1\n\n      try {\n        if (plugin.isGenerator) {\n          for (const yieldedPatches of plugin(mutations, that.getLib())) {\n            updatePatches(yieldedPatches)\n          }\n        }\n        else {\n          const newPatches = plugin(mutations, that.getLib())\n          updatePatches(newPatches)\n        }\n      }\n      catch (e) {\n        console.error(e) // eslint-disable-line no-console\n        updatePatches([Object.assign(Object.create(e), {plugin})])\n      }\n      finally {\n        that.updatePluginHistory(plugin, {mutationIndex: lastMutationIndex})\n      }\n\n      return that.dispatch()\n    }\n\n    function updatePatches(patches) {\n      if (patches) {\n        patches = lib.fullyNormalizeArray(patches)\n        that.updatePatches(patches, plugin)\n      }\n    }\n  }\n}\n\nexport default function mapSpec(opts) {\n  return new SpecMap(opts).dispatch()\n}\n\nconst plugins = {refs, allOf, parameters, properties}\nexport {SpecMap, plugins}\n","import isObject from 'lodash/isObject'\nimport startsWith from 'lodash/startsWith'\n\nconst toLower = str => String.prototype.toLowerCase.call(str)\nconst escapeString = (str) => {\n  return str.replace(/[^\\w]/gi, '_')\n}\n\n// Spec version detection\nexport function isOAS3(spec) {\n  const oasVersion = spec.openapi\n  if (!oasVersion) {\n    return false\n  }\n\n  return startsWith(oasVersion, '3')\n}\n\nexport function isSwagger2(spec) {\n  const swaggerVersion = spec.swagger\n  if (!swaggerVersion) {\n    return false\n  }\n\n  return startsWith(swaggerVersion, '2')\n}\n\n// Strategy for determining operationId\nexport function opId(operation, pathName, method = '', {v2OperationIdCompatibilityMode} = {}) {\n  if (!operation || typeof operation !== 'object') {\n    return null\n  }\n  const idWithoutWhitespace = (operation.operationId || '').replace(/\\s/g, '')\n  if (idWithoutWhitespace.length) {\n    return escapeString(operation.operationId)\n  }\n  return idFromPathMethod(pathName, method, {v2OperationIdCompatibilityMode})\n}\n\n\n// Create a generated operationId from pathName + method\nexport function idFromPathMethod(pathName, method, {v2OperationIdCompatibilityMode} = {}) {\n  if (v2OperationIdCompatibilityMode) {\n    let res = `${method.toLowerCase()}_${pathName}`\n      .replace(/[\\s!@#$%^&*()_+=[{\\]};:<>|./?,\\\\'\"\"-]/g, '_')\n\n    res = res || `${pathName.substring(1)}_${method}`\n\n    return res\n      .replace(/((_){2,})/g, '_')\n      .replace(/^(_)*/g, '')\n      .replace(/([_])*$/g, '')\n  }\n  return `${toLower(method)}${escapeString(pathName)}`\n}\n\nexport function legacyIdFromPathMethod(pathName, method) {\n  return `${toLower(method)}-${pathName}`\n}\n\n// Get the operation, based on operationId ( just return the object, no inheritence )\nexport function getOperationRaw(spec, id) {\n  if (!spec || !spec.paths) {\n    return null\n  }\n\n\n  return findOperation(spec, ({pathName, method, operation}) => {\n    if (!operation || typeof operation !== 'object') {\n      return false\n    }\n\n    const rawOperationId = operation.operationId // straight from the source\n    const operationId = opId(operation, pathName, method)\n    const legacyOperationId = legacyIdFromPathMethod(pathName, method)\n\n    return [operationId, legacyOperationId, rawOperationId]\n      .some(val => val && val === id)\n  })\n}\n\n// Will stop iterating over the operations and return the operationObj\n// as soon as predicate returns true\nexport function findOperation(spec, predicate) {\n  return eachOperation(spec, predicate, true) || null\n}\n\n// iterate over each operation, and fire a callback with details\n// `find=true` will stop iterating, when the cb returns truthy\nexport function eachOperation(spec, cb, find) {\n  if (!spec || typeof spec !== 'object' || !spec.paths || typeof spec.paths !== 'object') {\n    return null\n  }\n\n  const {paths} = spec\n\n  // Iterate over the spec, collecting operations\n  for (const pathName in paths) {\n    for (const method in paths[pathName]) {\n      if (method.toUpperCase() === 'PARAMETERS') {\n        continue\n      }\n      const operation = paths[pathName][method]\n      if (!operation || typeof operation !== 'object') {\n        continue\n      }\n\n      const operationObj = {\n        spec,\n        pathName,\n        method: method.toUpperCase(),\n        operation\n      }\n      const cbValue = cb(operationObj)\n\n      if (find && cbValue) {\n        return operationObj\n      }\n    }\n  }\n}\n\n// REVIEW: OAS3: identify normalization steps that need changes\n// ...maybe create `normalizeOAS3`?\n\nexport function normalizeSwagger(parsedSpec) {\n  const {spec} = parsedSpec\n  const {paths} = spec\n  const map = {}\n\n  if (!paths || spec.$$normalized) {\n    return parsedSpec\n  }\n\n  for (const pathName in paths) {\n    const path = paths[pathName]\n\n    if (!isObject(path)) {\n      continue\n    }\n\n    const pathParameters = path.parameters\n\n    for (const method in path) {\n      const operation = path[method]\n      if (!isObject(operation)) {\n        continue\n      }\n\n      const oid = opId(operation, pathName, method)\n\n      if (oid) {\n        if (map[oid]) {\n          map[oid].push(operation)\n        }\n        else {\n          map[oid] = [operation]\n        }\n\n        const opList = map[oid]\n        if (opList.length > 1) {\n          opList.forEach((o, i) => {\n            o.__originalOperationId = o.__originalOperationId || o.operationId\n            o.operationId = `${oid}${i + 1}`\n          })\n        }\n        else if (typeof operation.operationId !== 'undefined') {\n          // Ensure we always add the normalized operation ID if one already exists\n          // ( potentially different, given that we normalize our IDs)\n          // ... _back_ to the spec. Otherwise, they might not line up\n          const obj = opList[0]\n          obj.__originalOperationId = obj.__originalOperationId || operation.operationId\n          obj.operationId = oid\n        }\n      }\n\n      if (method !== 'parameters') {\n        // Add inherited consumes, produces, parameters, securities\n        const inheritsList = []\n        const toBeInherit = {}\n\n        // Global-levels\n        for (const key in spec) {\n          if (key === 'produces' || key === 'consumes' || key === 'security') {\n            toBeInherit[key] = spec[key]\n            inheritsList.push(toBeInherit)\n          }\n        }\n\n        // Path-levels\n        if (pathParameters) {\n          toBeInherit.parameters = pathParameters\n          inheritsList.push(toBeInherit)\n        }\n\n        if (inheritsList.length) {\n          for (const inherits of inheritsList) {\n            for (const inheritName in inherits) {\n              if (!operation[inheritName]) {\n                operation[inheritName] = inherits[inheritName]\n              }\n              else if (inheritName === 'parameters') {\n                for (const param of inherits[inheritName]) {\n                  const exists = operation[inheritName].some((opParam) => {\n                    return (opParam.name && opParam.name === param.name)\n                      || (opParam.$ref && opParam.$ref === param.$ref)\n                      || (opParam.$$ref && opParam.$$ref === param.$$ref)\n                      || (opParam === param)\n                  })\n\n                  if (!exists) {\n                    operation[inheritName].push(param)\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n\n  spec.$$normalized = true\n\n  return parsedSpec\n}\n","import Http from './http'\nimport mapSpec, {plugins} from './specmap'\nimport {normalizeSwagger} from './helpers'\nimport {ACCEPT_HEADER_VALUE_FOR_DOCUMENTS} from './constants'\n\nexport function makeFetchJSON(http, opts = {}) {\n  const {requestInterceptor, responseInterceptor} = opts\n  // Set credentials with 'http.withCredentials' value\n  const credentials = (http.withCredentials) ? 'include' : 'same-origin'\n  return (docPath) => {\n    return http({\n      url: docPath,\n      loadSpec: true,\n      requestInterceptor,\n      responseInterceptor,\n      headers: {\n        Accept: ACCEPT_HEADER_VALUE_FOR_DOCUMENTS\n      },\n      credentials\n    })\n    .then((res) => {\n      return res.body\n    })\n  }\n}\n\n// Wipe out the http cache\nexport function clearCache() {\n  plugins.refs.clearCache()\n}\n\nexport default function resolve(obj) {\n  const {\n    fetch, spec, url, mode, allowMetaPatches = true, pathDiscriminator,\n    modelPropertyMacro, parameterMacro, requestInterceptor,\n    responseInterceptor, skipNormalization, useCircularStructures,\n  } = obj\n\n  let {http, baseDoc} = obj\n\n  // @TODO Swagger-UI uses baseDoc instead of url, this is to allow both\n  // need to fix and pick one.\n  baseDoc = baseDoc || url\n\n  // Provide a default fetch implementation\n  // TODO fetch should be removed, and http used instead\n  http = fetch || http || Http\n\n  if (!spec) {\n    return makeFetchJSON(http, {requestInterceptor, responseInterceptor})(baseDoc).then(doResolve)\n  }\n\n  return doResolve(spec)\n\n  function doResolve(_spec) {\n    if (baseDoc) {\n      plugins.refs.docCache[baseDoc] = _spec\n    }\n\n    // Build a json-fetcher ( ie: give it a URL and get json out )\n    plugins.refs.fetchJSON = makeFetchJSON(http, {requestInterceptor, responseInterceptor})\n\n    const plugs = [plugins.refs]\n\n    if (typeof parameterMacro === 'function') {\n      plugs.push(plugins.parameters)\n    }\n\n    if (typeof modelPropertyMacro === 'function') {\n      plugs.push(plugins.properties)\n    }\n\n    if (mode !== 'strict') {\n      plugs.push(plugins.allOf)\n    }\n\n    // mapSpec is where the hard work happens, see https://github.com/swagger-api/specmap for more details\n    return mapSpec({\n      spec: _spec,\n      context: {baseDoc},\n      plugins: plugs,\n      allowMetaPatches, // allows adding .meta patches, which include adding `$$ref`s to the spec\n      pathDiscriminator, // for lazy resolution\n      parameterMacro,\n      modelPropertyMacro,\n      useCircularStructures,\n    }).then(skipNormalization ? async a => a : normalizeSwagger)\n  }\n}\n","// The subtree resolver is a higher-level interface that allows you to\n// get the same result that you would from `Swagger.resolve`, but focuses on\n// a subtree of your object.\n//\n// It makes several assumptions that allow you to think less about what resolve,\n// specmap, and normalizeSwagger are doing: if this is not suitable for you,\n// you can emulate `resolveSubtree`'s behavior by talking to the traditional\n// resolver directly.\n//\n// By providing a top-level `obj` and a `path` to resolve within, the subtree\n// at `path` will be resolved and normalized in the context of your top-level\n// `obj`. You'll get the resolved subtree you're interest in as a return value\n// (or, you can use `returnEntireTree` to get everything back).\n//\n// This is useful for cases where resolving your entire object is unnecessary\n// and/or non-performant; we use this interface for lazily resolving operations\n// and models in Swagger-UI, which allows us to handle larger definitions.\n//\n// It's likely that Swagger-Client will rely entirely on lazy resolving in\n// future versions.\n//\n// TODO: move the remarks above into project documentation\n\n\nimport get from 'lodash/get'\nimport resolve from '../resolver'\nimport {normalizeSwagger} from '../helpers'\n\nexport default async function resolveSubtree(obj, path, opts = {}) {\n  const {\n    returnEntireTree,\n    baseDoc,\n    requestInterceptor,\n    responseInterceptor,\n    parameterMacro,\n    modelPropertyMacro,\n    useCircularStructures,\n  } = opts\n\n  const resolveOptions = {\n    pathDiscriminator: path,\n    baseDoc,\n    requestInterceptor,\n    responseInterceptor,\n    parameterMacro,\n    modelPropertyMacro,\n    useCircularStructures,\n  }\n\n  const {spec: normalized} = normalizeSwagger({\n    spec: obj\n  })\n\n  const result = await resolve({\n    ...resolveOptions,\n    spec: normalized,\n    allowMetaPatches: true,\n    skipNormalization: true\n  })\n\n  if (!returnEntireTree && Array.isArray(path) && path.length) {\n    result.spec = get(result.spec, path) || null\n  }\n\n  return result\n}\n","import pick from 'lodash/pick'\nimport {eachOperation, opId} from './helpers'\n\nconst nullFn = () => null\n\nconst normalizeArray = (arg) => {\n  return Array.isArray(arg) ? arg : [arg]\n}\n\n// To allow stubbing of functions\nexport const self = {\n  mapTagOperations,\n  makeExecute\n}\n\n// Make an execute, bound to arguments defined in mapTagOperation's callback (cb)\nexport function makeExecute(swaggerJs = {}) {\n  return ({pathName, method, operationId}) => (parameters, opts = {}) => {\n    return swaggerJs.execute({\n      spec: swaggerJs.spec,\n      ...pick(swaggerJs, 'requestInterceptor', 'responseInterceptor', 'userFetch'),\n      pathName,\n      method,\n      parameters,\n      operationId,\n      ...opts\n    })\n  }\n}\n\n// Creates an interface with tags+operations = execute\n// The shape\n// { apis: { [tag]: { operations: [operation]: { execute }}}}\n// NOTE: this is mostly for compatibility\nexport function makeApisTagOperationsOperationExecute(swaggerJs = {}) {\n  // { apis: tag: operations: execute }\n  const cb = self.makeExecute(swaggerJs)\n  const tagOperations = self.mapTagOperations({\n    v2OperationIdCompatibilityMode: swaggerJs.v2OperationIdCompatibilityMode,\n    spec: swaggerJs.spec,\n    cb,\n  })\n\n  const apis = {}\n  for (const tag in tagOperations) {\n    apis[tag] = {\n      operations: {}\n    }\n    for (const op in tagOperations[tag]) {\n      apis[tag].operations[op] = {execute: tagOperations[tag][op]}\n    }\n  }\n\n  return {apis}\n}\n\n// .apis[tag][operationId]:ExecuteFunction interface\nexport function makeApisTagOperation(swaggerJs = {}) {\n  const cb = self.makeExecute(swaggerJs)\n  return {\n    apis: self.mapTagOperations({\n      v2OperationIdCompatibilityMode: swaggerJs.v2OperationIdCompatibilityMode,\n      spec: swaggerJs.spec,\n      cb\n    })\n  }\n}\n\n/**\n * Iterates over a spec, creating a hash of {[tag]: { [operationId], ... }, ...}\n * with the value of calling `cb`.\n *\n * `spec` is a OAI v2.0 compliant specification object\n * `cb` is called with ({ spec, operation, path, method })\n * `defaultTag` will house all non-tagged operations\n *\n */\nexport function mapTagOperations({spec, cb = nullFn, defaultTag = 'default', v2OperationIdCompatibilityMode}) {\n  const operationIdCounter = {}\n  const tagOperations = {} // Will house all tags + operations\n  eachOperation(spec, ({pathName, method, operation}) => {\n    const tags = operation.tags ? normalizeArray(operation.tags) : [defaultTag]\n\n    tags.forEach((tag) => {\n      if (typeof tag !== 'string') {\n        return\n      }\n      const tagObj = tagOperations[tag] = tagOperations[tag] || {}\n      const id = opId(operation, pathName, method, {v2OperationIdCompatibilityMode})\n      const cbResult = cb({spec, pathName, method, operation, operationId: id})\n\n      if (operationIdCounter[id]) {\n        operationIdCounter[id]++\n        tagObj[`${id}${operationIdCounter[id]}`] = cbResult\n      }\n      else if (typeof tagObj[id] !== 'undefined') {\n        // Bump counter ( for this operationId )\n        const originalCounterValue = (operationIdCounter[id] || 1)\n        operationIdCounter[id] = originalCounterValue + 1\n        // Append _x to the operationId\n        tagObj[`${id}${operationIdCounter[id]}`] = cbResult\n\n        // Rename the first operationId\n        const temp = tagObj[id]\n        delete tagObj[id]\n        tagObj[`${id}${originalCounterValue}`] = temp\n      }\n      else {\n        // Assign callback result ( usually a bound function )\n        tagObj[id] = cbResult\n      }\n    })\n  })\n\n  return tagOperations\n}\n","// These functions will update the request.\n// They'll be given {req, value, paramter, spec, operation}.\n\n\nexport default {\n  body: bodyBuilder,\n  header: headerBuilder,\n  query: queryBuilder,\n  path: pathBuilder,\n  formData: formDataBuilder\n}\n\n\n// Add the body to the request\nfunction bodyBuilder({req, value}) {\n  req.body = value\n}\n\n// Add a form data object.\nfunction formDataBuilder({req, value, parameter}) {\n  if (value || parameter.allowEmptyValue) {\n    req.form = req.form || {}\n    req.form[parameter.name] = {\n      value,\n      allowEmptyValue: parameter.allowEmptyValue,\n      collectionFormat: parameter.collectionFormat,\n    }\n  }\n}\n\n// Add a header to the request\nfunction headerBuilder({req, parameter, value}) {\n  req.headers = req.headers || {}\n  if (typeof value !== 'undefined') {\n    req.headers[parameter.name] = value\n  }\n}\n\n// Replace path paramters, with values ( ie: the URL )\nfunction pathBuilder({req, value, parameter}) {\n  req.url = req.url.split(`{${parameter.name}}`).join(encodeURIComponent(value))\n}\n\n// Add a query to the `query` object, which will later be stringified into the URL's search\nfunction queryBuilder({req, value, parameter}) {\n  req.query = req.query || {}\n\n  if (value === false && parameter.type === 'boolean') {\n    value = 'false'\n  }\n\n  if (value === 0 && ['number', 'integer'].indexOf(parameter.type) > -1) {\n    value = '0'\n  }\n\n  if (value) {\n    req.query[parameter.name] = {\n      collectionFormat: parameter.collectionFormat,\n      value\n    }\n  }\n  else if (parameter.allowEmptyValue && value !== undefined) {\n    const paramName = parameter.name\n    req.query[paramName] = req.query[paramName] || {}\n    req.query[paramName].allowEmptyValue = true\n  }\n}\n","import encodeToRFC3986 from 'encode-3986'\nimport toUTF8Bytes from 'utf8-bytes'\nimport {stringToCharArray} from 'utfstring'\n\nconst isRfc3986Reserved = char => ':/?#[]@!$&\\'()*+,;='.indexOf(char) > -1\nconst isRrc3986Unreserved = (char) => {\n  return (/^[a-z0-9\\-._~]+$/i).test(char)\n}\n\nexport function encodeDisallowedCharacters(str, {escape} = {}, parse) {\n  if (typeof str === 'number') {\n    str = str.toString()\n  }\n  if (typeof str !== 'string' || !str.length) {\n    return str\n  }\n\n  if (!escape) {\n    return str\n  }\n\n  if (parse) {\n    return JSON.parse(str)\n  }\n\n  return stringToCharArray(str).map((char) => {\n    if (isRrc3986Unreserved(char)) {\n      return char\n    }\n\n    if (isRfc3986Reserved(char) && escape === 'unsafe') {\n      return char\n    }\n\n    const encoded = (toUTF8Bytes(char) || [])\n      .map(byte => `0${byte.toString(16).toUpperCase()}`.slice(-2))\n      .map(encodedByte => `%${encodedByte}`)\n      .join('')\n\n    return encoded\n  }).join('')\n}\n\nexport default function stylize(config) {\n  const {value} = config\n\n  if (Array.isArray(value)) {\n    return encodeArray(config)\n  }\n  else if (typeof value === 'object') {\n    return encodeObject(config)\n  }\n  return encodePrimitive(config)\n}\n\nfunction encodeArray({key, value, style, explode, escape}) {\n  const valueEncoder = str => encodeDisallowedCharacters(str, {\n    escape\n  })\n\n  if (style === 'simple') {\n    return value.map(val => valueEncoder(val)).join(',')\n  }\n\n  if (style === 'label') {\n    return `.${value.map(val => valueEncoder(val)).join('.')}`\n  }\n\n  if (style === 'matrix') {\n    return value.map(val => valueEncoder(val)).reduce((prev, curr) => {\n      if (!prev || explode) {\n        return `${(prev || '')};${key}=${curr}`\n      }\n      return `${prev},${curr}`\n    }, '')\n  }\n\n  if (style === 'form') {\n    const after = explode ? `&${key}=` : ','\n    return value.map(val => valueEncoder(val)).join(after)\n  }\n\n  if (style === 'spaceDelimited') {\n    const after = explode ? `${key}=` : ''\n    return value.map(val => valueEncoder(val)).join(` ${after}`)\n  }\n\n  if (style === 'pipeDelimited') {\n    const after = explode ? `${key}=` : ''\n    return value.map(val => valueEncoder(val)).join(`|${after}`)\n  }\n}\n\nfunction encodeObject({key, value, style, explode, escape}) {\n  const valueEncoder = str => encodeDisallowedCharacters(str, {\n    escape\n  })\n\n  const valueKeys = Object.keys(value)\n\n  if (style === 'simple') {\n    return valueKeys.reduce((prev, curr) => {\n      const val = valueEncoder(value[curr])\n      const middleChar = explode ? '=' : ','\n      const prefix = prev ? `${prev},` : ''\n\n      return `${prefix}${curr}${middleChar}${val}`\n    }, '')\n  }\n\n  if (style === 'label') {\n    return valueKeys.reduce((prev, curr) => {\n      const val = valueEncoder(value[curr])\n      const middleChar = explode ? '=' : '.'\n      const prefix = prev ? `${prev}.` : '.'\n\n      return `${prefix}${curr}${middleChar}${val}`\n    }, '')\n  }\n\n  if (style === 'matrix' && explode) {\n    return valueKeys.reduce((prev, curr) => {\n      const val = valueEncoder(value[curr])\n      const prefix = prev ? `${prev};` : ';'\n\n      return `${prefix}${curr}=${val}`\n    }, '')\n  }\n\n  if (style === 'matrix') {\n    // no explode\n    return valueKeys.reduce((prev, curr) => {\n      const val = valueEncoder(value[curr])\n      const prefix = prev ? `${prev},` : `;${key}=`\n\n      return `${prefix}${curr},${val}`\n    }, '')\n  }\n\n  if (style === 'form') {\n    return valueKeys.reduce((prev, curr) => {\n      const val = valueEncoder(value[curr])\n      const prefix = prev ? `${prev}${explode ? '&' : ','}` : ''\n      const separator = explode ? '=' : ','\n\n      return `${prefix}${curr}${separator}${val}`\n    }, '')\n  }\n}\n\nfunction encodePrimitive({key, value, style, escape}) {\n  const valueEncoder = str => encodeDisallowedCharacters(str, {\n    escape\n  })\n\n  if (style === 'simple') {\n    return valueEncoder(value)\n  }\n\n  if (style === 'label') {\n    return `.${valueEncoder(value)}`\n  }\n\n  if (style === 'matrix') {\n    return `;${key}=${valueEncoder(value)}`\n  }\n\n  if (style === 'form') {\n    return valueEncoder(value)\n  }\n\n  if (style === 'deepObject') {\n    return valueEncoder(value, {}, true)\n  }\n}\n","/*\n  Serializer that serializes according to a media type instead of OpenAPI's\n  `style` + `explode` constructs.\n*/\n\nexport default function serialize(value, mediaType) {\n  if (mediaType.includes('application/json')) {\n    if (typeof value === 'string') {\n      // Assume the user has a JSON string\n      return value\n    }\n    return JSON.stringify(value)\n  }\n\n  return value.toString()\n}\n","import stylize, {encodeDisallowedCharacters} from './style-serializer'\nimport serialize from './content-serializer'\n\nexport function path({req, value, parameter}) {\n  const {name, style, explode, content} = parameter\n\n  if (content) {\n    const effectiveMediaType = Object.keys(content)[0]\n\n    req.url = req.url.split(`{${name}}`).join(\n      encodeDisallowedCharacters(\n        serialize(value, effectiveMediaType),\n        {escape: true}\n      )\n    )\n    return\n  }\n\n  const styledValue = stylize({\n    key: parameter.name,\n    value,\n    style: style || 'simple',\n    explode: explode || false,\n    escape: true,\n  })\n\n  req.url = req.url.split(`{${name}}`).join(styledValue)\n}\n\nexport function query({req, value, parameter}) {\n  req.query = req.query || {}\n\n  if (parameter.content) {\n    const effectiveMediaType = Object.keys(parameter.content)[0]\n\n    req.query[parameter.name] = serialize(value, effectiveMediaType)\n    return\n  }\n\n  if (value === false) {\n    value = 'false'\n  }\n\n  if (value === 0) {\n    value = '0'\n  }\n\n  if (value) {\n    const type = typeof value\n\n    if (parameter.style === 'deepObject') {\n      const valueKeys = Object.keys(value)\n      valueKeys.forEach((k) => {\n        const v = value[k]\n        req.query[`${parameter.name}[${k}]`] = {\n          value: stylize({\n            key: k,\n            value: v,\n            style: 'deepObject',\n            escape: parameter.allowReserved ? 'unsafe' : 'reserved',\n          }),\n          skipEncoding: true\n        }\n      })\n    }\n    else if (\n      type === 'object' &&\n      !Array.isArray(value) &&\n      (parameter.style === 'form' || !parameter.style) &&\n      (parameter.explode || parameter.explode === undefined)\n    ) {\n      // form explode needs to be handled here,\n      // since we aren't assigning to `req.query[parameter.name]`\n      // like we usually do.\n      const valueKeys = Object.keys(value)\n      valueKeys.forEach((k) => {\n        const v = value[k]\n        req.query[k] = {\n          value: stylize({\n            key: k,\n            value: v,\n            style: parameter.style || 'form',\n            escape: parameter.allowReserved ? 'unsafe' : 'reserved',\n          }),\n          skipEncoding: true\n        }\n      })\n    }\n    else {\n      const encodedParamName = encodeURIComponent(parameter.name)\n      req.query[encodedParamName] = {\n        value: stylize({\n          key: encodedParamName,\n          value,\n          style: parameter.style || 'form',\n          explode: typeof parameter.explode === 'undefined' ? true : parameter.explode,\n          escape: parameter.allowReserved ? 'unsafe' : 'reserved',\n        }),\n        skipEncoding: true\n      }\n    }\n  }\n  else if (parameter.allowEmptyValue && value !== undefined) {\n    const paramName = parameter.name\n    req.query[paramName] = req.query[paramName] || {}\n    req.query[paramName].allowEmptyValue = true\n  }\n}\n\nconst PARAMETER_HEADER_BLACKLIST = [\n  'accept',\n  'authorization',\n  'content-type'\n]\n\nexport function header({req, parameter, value}) {\n  req.headers = req.headers || {}\n\n  if (PARAMETER_HEADER_BLACKLIST.indexOf(parameter.name.toLowerCase()) > -1) {\n    return\n  }\n\n  if (parameter.content) {\n    const effectiveMediaType = Object.keys(parameter.content)[0]\n\n    req.headers[parameter.name] = serialize(value, effectiveMediaType)\n    return\n  }\n\n  if (typeof value !== 'undefined') {\n    req.headers[parameter.name] = stylize({\n      key: parameter.name,\n      value,\n      style: parameter.style || 'simple',\n      explode: typeof parameter.explode === 'undefined' ? false : parameter.explode,\n      escape: false,\n    })\n  }\n}\n\nexport function cookie({req, parameter, value}) {\n  req.headers = req.headers || {}\n  const type = typeof value\n\n  if (parameter.content) {\n    const effectiveMediaType = Object.keys(parameter.content)[0]\n\n    req.headers.Cookie = `${parameter.name}=${serialize(value, effectiveMediaType)}`\n    return\n  }\n\n  if (type !== 'undefined') {\n    const prefix = (\n      type === 'object' &&\n      !Array.isArray(value) &&\n      parameter.explode\n    ) ? '' : `${parameter.name}=`\n\n    req.headers.Cookie = prefix + stylize({\n      key: parameter.name,\n      value,\n      escape: false,\n      style: parameter.style || 'form',\n      explode: typeof parameter.explode === 'undefined' ? false : parameter.explode\n    })\n  }\n}\n","// This function runs after the common function,\n// `src/execute/index.js#buildRequest`\nimport assign from 'lodash/assign'\nimport get from 'lodash/get'\nimport btoa from 'btoa'\nimport {Buffer} from 'buffer/'\n\nexport default function (options, req) {\n  const {\n    operation,\n    requestBody,\n    securities,\n    spec,\n    attachContentTypeForEmptyPayload\n  } = options\n\n  let {\n    requestContentType\n  } = options\n\n  req = applySecurities({request: req, securities, operation, spec})\n\n  const requestBodyDef = operation.requestBody || {}\n  const requestBodyMediaTypes = Object.keys(requestBodyDef.content || {})\n  const isExplicitContentTypeValid = requestContentType\n  && requestBodyMediaTypes.indexOf(requestContentType) > -1\n\n  // for OAS3: set the Content-Type\n  if (requestBody || attachContentTypeForEmptyPayload) {\n    // does the passed requestContentType appear in the requestBody definition?\n\n    if (requestContentType && isExplicitContentTypeValid) {\n      req.headers['Content-Type'] = requestContentType\n    }\n    else if (!requestContentType) {\n      const firstMediaType = requestBodyMediaTypes[0]\n      if (firstMediaType) {\n        req.headers['Content-Type'] = firstMediaType\n        requestContentType = firstMediaType\n      }\n    }\n  }\n  else if (requestContentType && isExplicitContentTypeValid) {\n    req.headers['Content-Type'] = requestContentType\n  }\n\n  // for OAS3: add requestBody to request\n  if (requestBody) {\n    if (requestContentType) {\n      if (requestBodyMediaTypes.indexOf(requestContentType) > -1) {\n        // only attach body if the requestBody has a definition for the\n        // contentType that has been explicitly set\n        if (requestContentType === 'application/x-www-form-urlencoded' || requestContentType.indexOf('multipart/') === 0) {\n          if (typeof requestBody === 'object') {\n            req.form = {}\n            Object.keys(requestBody).forEach((k) => {\n              const val = requestBody[k]\n              let newVal\n\n              let isFile\n\n              if (typeof File !== 'undefined') {\n                isFile = val instanceof File // eslint-disable-line no-undef\n              }\n\n              if (typeof Blob !== 'undefined') {\n                isFile = isFile || val instanceof Blob // eslint-disable-line no-undef\n              }\n\n              if (typeof Buffer !== 'undefined') {\n                isFile = isFile || Buffer.isBuffer(val)\n              }\n\n              if (typeof val === 'object' && !isFile) {\n                if (Array.isArray(val)) {\n                  newVal = val.toString()\n                }\n                else {\n                  newVal = JSON.stringify(val)\n                }\n              }\n              else {\n                newVal = val\n              }\n\n              req.form[k] = {\n                value: newVal\n              }\n            })\n          }\n          else {\n            req.form = requestBody\n          }\n        }\n        else {\n          req.body = requestBody\n        }\n      }\n    }\n    else {\n      req.body = requestBody\n    }\n  }\n\n  return req\n}\n\n// Add security values, to operations - that declare their need on them\n// Adapted from the Swagger2 implementation\nexport function applySecurities({request, securities = {}, operation = {}, spec}) {\n  const result = assign({}, request)\n  const {authorized = {}} = securities\n  const security = operation.security || spec.security || []\n  const isAuthorized = authorized && !!Object.keys(authorized).length\n  const securityDef = get(spec, ['components', 'securitySchemes']) || {}\n\n  result.headers = result.headers || {}\n  result.query = result.query || {}\n\n  if (!Object.keys(securities).length || !isAuthorized || !security ||\n      (Array.isArray(operation.security) && !operation.security.length)) {\n    return request\n  }\n\n  security.forEach((securityObj, index) => {\n    for (const key in securityObj) {\n      const auth = authorized[key]\n      const schema = securityDef[key]\n\n      if (!auth) {\n        continue\n      }\n\n      const value = auth.value || auth\n      const {type} = schema\n\n      if (auth) {\n        if (type === 'apiKey') {\n          if (schema.in === 'query') {\n            result.query[schema.name] = value\n          }\n          if (schema.in === 'header') {\n            result.headers[schema.name] = value\n          }\n          if (schema.in === 'cookie') {\n            result.cookies[schema.name] = value\n          }\n        }\n        else if (type === 'http') {\n          if (schema.scheme === 'basic') {\n            const {username, password} = value\n            const encoded = btoa(`${username}:${password}`)\n            result.headers.Authorization = `Basic ${encoded}`\n          }\n\n          if (schema.scheme === 'bearer') {\n            result.headers.Authorization = `Bearer ${value}`\n          }\n        }\n        else if (type === 'oauth2') {\n          const token = auth.token || {}\n          const tokenName = schema['x-tokenName'] || 'access_token'\n          const tokenValue = token[tokenName]\n          let tokenType = token.token_type\n\n          if (!tokenType || tokenType.toLowerCase() === 'bearer') {\n            tokenType = 'Bearer'\n          }\n\n          result.headers.Authorization = `${tokenType} ${tokenValue}`\n        }\n      }\n    }\n  })\n\n  return result\n}\n","// This function runs after the common function,\n// `src/execute/index.js#buildRequest`\n\nimport btoa from 'btoa'\nimport assign from 'lodash/assign'\nimport http from '../../http'\n\n\nexport default function (options, req) {\n  const {\n    spec,\n    operation,\n    securities,\n    requestContentType,\n    attachContentTypeForEmptyPayload\n  } = options\n  // Add securities, which are applicable\n  req = applySecurities({request: req, securities, operation, spec})\n\n  if (req.body || req.form || attachContentTypeForEmptyPayload) {\n    // all following conditionals are Swagger2 only\n    if (requestContentType) {\n      req.headers['Content-Type'] = requestContentType\n    }\n    else if (Array.isArray(operation.consumes)) {\n      req.headers['Content-Type'] = operation.consumes[0]\n    }\n    else if (Array.isArray(spec.consumes)) {\n      req.headers['Content-Type'] = spec.consumes[0]\n    }\n    else if (operation.parameters && operation.parameters.filter(p => p.type === 'file').length) {\n      req.headers['Content-Type'] = 'multipart/form-data'\n    }\n    else if (operation.parameters && operation.parameters.filter(p => p.in === 'formData').length) {\n      req.headers['Content-Type'] = 'application/x-www-form-urlencoded'\n    }\n  }\n  else if (requestContentType) {\n    const isBodyParamPresent = operation.parameters && operation.parameters.filter(p => p.in === 'body').length > 0\n    const isFormDataParamPresent = operation.parameters && operation.parameters.filter(p => p.in === 'formData').length > 0\n    if (isBodyParamPresent || isFormDataParamPresent) {\n      req.headers['Content-Type'] = requestContentType\n    }\n  }\n\n  return req\n}\n\n// Add security values, to operations - that declare their need on them\nexport function applySecurities({request, securities = {}, operation = {}, spec}) {\n  const result = assign({}, request)\n  const {authorized = {}, specSecurity = []} = securities\n  const security = operation.security || specSecurity\n  const isAuthorized = authorized && !!Object.keys(authorized).length\n  const securityDef = spec.securityDefinitions\n\n  result.headers = result.headers || {}\n  result.query = result.query || {}\n\n  if (!Object.keys(securities).length || !isAuthorized || !security ||\n      (Array.isArray(operation.security) && !operation.security.length)) {\n    return request\n  }\n\n  security.forEach((securityObj, index) => {\n    for (const key in securityObj) {\n      const auth = authorized[key]\n      if (!auth) {\n        continue\n      }\n\n      const token = auth.token\n      const value = auth.value || auth\n      const schema = securityDef[key]\n      const {type} = schema\n      const tokenName = schema['x-tokenName'] || 'access_token'\n      const oauthToken = token && token[tokenName]\n      let tokenType = token && token.token_type\n\n      if (auth) {\n        if (type === 'apiKey') {\n          const inType = schema.in === 'query' ? 'query' : 'headers'\n          result[inType] = result[inType] || {}\n          result[inType][schema.name] = value\n        }\n        else if (type === 'basic') {\n          if (value.header) {\n            result.headers.authorization = value.header\n          }\n          else {\n            value.base64 = btoa(`${value.username}:${value.password}`)\n            result.headers.authorization = `Basic ${value.base64}`\n          }\n        }\n        else if (type === 'oauth2' && oauthToken) {\n          tokenType = (!tokenType || tokenType.toLowerCase() === 'bearer') ? 'Bearer' : tokenType\n          result.headers.authorization = `${tokenType} ${oauthToken}`\n        }\n      }\n    }\n  })\n\n  return result\n}\n","import assign from 'lodash/assign'\nimport getIn from 'lodash/get'\nimport isPlainObject from 'lodash/isPlainObject'\nimport isArray from 'lodash/isArray'\nimport btoa from 'btoa'\nimport url from 'url'\nimport cookie from 'cookie'\nimport stockHttp, {mergeInQueryOrForm} from '../http'\nimport createError from '../specmap/lib/create-error'\n\nimport SWAGGER2_PARAMETER_BUILDERS from './swagger2/parameter-builders'\nimport * as OAS3_PARAMETER_BUILDERS from './oas3/parameter-builders'\nimport oas3BuildRequest from './oas3/build-request'\nimport swagger2BuildRequest from './swagger2/build-request'\nimport {\n  getOperationRaw,\n  idFromPathMethod,\n  legacyIdFromPathMethod,\n  isOAS3\n} from '../helpers'\n\nconst arrayOrEmpty = (ar) => {\n  return Array.isArray(ar) ? ar : []\n}\n\nconst OperationNotFoundError = createError('OperationNotFoundError', function (message, extra, oriError) {\n  this.originalError = oriError\n  Object.assign(this, extra || {})\n})\n\nconst findParametersWithName = (name, parameters) => {\n  return parameters.filter(p => p.name === name)\n}\n\n// removes parameters that have duplicate 'in' and 'name' properties\nconst deduplicateParameters = (parameters) => {\n  const paramsMap = {}\n  parameters.forEach((p) => {\n    if (!paramsMap[p.in]) {\n      paramsMap[p.in] = {}\n    }\n    paramsMap[p.in][p.name] = p\n  })\n\n  const dedupedParameters = []\n  Object.keys(paramsMap).forEach((i) => {\n    Object.keys(paramsMap[i]).forEach((p) => {\n      dedupedParameters.push(paramsMap[i][p])\n    })\n  })\n  return dedupedParameters\n}\n\n// For stubbing in tests\nexport const self = {\n  buildRequest\n}\n\n// Execute request, with the given operationId and parameters\n// pathName/method or operationId is optional\nexport function execute({\n  http: userHttp,\n  fetch, // This is legacy\n  spec,\n  operationId,\n  pathName,\n  method,\n  parameters,\n  securities,\n  ...extras\n}) {\n  // Provide default fetch implementation\n  const http = userHttp || fetch || stockHttp // Default to _our_ http\n\n  if (pathName && method && !operationId) {\n    operationId = legacyIdFromPathMethod(pathName, method)\n  }\n\n  const request = self.buildRequest({spec, operationId, parameters, securities, http, ...extras})\n\n  if (request.body && (isPlainObject(request.body) || isArray(request.body))) {\n    request.body = JSON.stringify(request.body)\n  }\n\n  // Build request and execute it\n  return http(request)\n}\n\n// Build a request, which can be handled by the `http.js` implementation.\nexport function buildRequest(options) {\n  const {\n    spec,\n    operationId,\n    securities,\n    requestContentType,\n    responseContentType,\n    scheme,\n    requestInterceptor,\n    responseInterceptor,\n    contextUrl,\n    userFetch,\n    requestBody,\n    server,\n    serverVariables,\n    http\n  } = options\n\n  let {\n    parameters,\n    parameterBuilders\n  } = options\n\n  const specIsOAS3 = isOAS3(spec)\n  if (!parameterBuilders) {\n    // user did not provide custom parameter builders\n    if (specIsOAS3) {\n      parameterBuilders = OAS3_PARAMETER_BUILDERS\n    }\n    else {\n      parameterBuilders = SWAGGER2_PARAMETER_BUILDERS\n    }\n  }\n\n  // Set credentials with 'http.withCredentials' value\n  const credentials = (http && http.withCredentials) ? 'include' : 'same-origin'\n\n  // Base Template\n  let req = {\n    url: '',\n    credentials,\n    headers: {},\n    cookies: {}\n  }\n\n  if (requestInterceptor) {\n    req.requestInterceptor = requestInterceptor\n  }\n  if (responseInterceptor) {\n    req.responseInterceptor = responseInterceptor\n  }\n  if (userFetch) {\n    req.userFetch = userFetch\n  }\n\n  const operationRaw = getOperationRaw(spec, operationId)\n  if (!operationRaw) {\n    throw new OperationNotFoundError(`Operation ${operationId} not found`)\n  }\n\n  const {operation = {}, method, pathName} = operationRaw\n\n  req.url += baseUrl({spec, scheme, contextUrl, server, serverVariables, pathName, method})\n\n  // Mostly for testing\n  if (!operationId) {\n    // Not removing req.cookies causes testing issues and would\n    // change our interface, so we're always sure to remove it.\n    // See the same statement lower down in this function for\n    // more context.\n    delete req.cookies\n    return req\n  }\n\n  req.url += pathName // Have not yet replaced the path parameters\n  req.method = (`${method}`).toUpperCase()\n\n  parameters = parameters || {}\n  const path = spec.paths[pathName] || {}\n\n  if (responseContentType) {\n    req.headers.accept = responseContentType\n  }\n\n  const combinedParameters = deduplicateParameters([]\n    .concat(arrayOrEmpty(operation.parameters)) // operation parameters\n    .concat(arrayOrEmpty(path.parameters)) // path parameters\n  )\n\n  // REVIEW: OAS3: have any key names or parameter shapes changed?\n  // Any new features that need to be plugged in here?\n\n\n  // Add values to request\n  combinedParameters.forEach((parameter) => {\n    const builder = parameterBuilders[parameter.in]\n    let value\n\n    if (parameter.in === 'body' && parameter.schema && parameter.schema.properties) {\n      value = parameters\n    }\n\n    value = parameter && parameter.name && parameters[parameter.name]\n\n    if (typeof value === 'undefined') {\n        // check for `name-in` formatted key\n      value = parameter && parameter.name && parameters[`${parameter.in}.${parameter.name}`]\n    }\n    else if (findParametersWithName(parameter.name, combinedParameters).length > 1) {\n      // value came from `parameters[parameter.name]`\n      // check to see if this is an ambiguous parameter\n      // eslint-disable-next-line no-console\n      console.warn(`Parameter '${parameter.name}' is ambiguous because the defined spec has more than one parameter with the name: '${parameter.name}' and the passed-in parameter values did not define an 'in' value.`)\n    }\n\n    if (value === null) {\n      return\n    }\n\n    if (typeof parameter.default !== 'undefined' && typeof value === 'undefined') {\n      value = parameter.default\n    }\n\n    if (typeof value === 'undefined' && parameter.required && !parameter.allowEmptyValue) {\n      throw new Error(`Required parameter ${parameter.name} is not provided`)\n    }\n\n    if (specIsOAS3 && parameter.schema && parameter.schema.type === 'object' && typeof value === 'string') {\n      try {\n        value = JSON.parse(value)\n      }\n      catch (e) {\n        throw new Error('Could not parse object parameter value string as JSON')\n      }\n    }\n\n    if (builder) {\n      builder({req, parameter, value, operation, spec})\n    }\n  })\n\n  // Do version-specific tasks, then return those results.\n  const versionSpecificOptions = {...options, operation}\n\n  if (specIsOAS3) {\n    req = oas3BuildRequest(versionSpecificOptions, req)\n  }\n  else {\n    // If not OAS3, then treat as Swagger2.\n    req = swagger2BuildRequest(versionSpecificOptions, req)\n  }\n\n\n  // If the cookie convenience object exists in our request,\n  // serialize its content and then delete the cookie object.\n  if (req.cookies && Object.keys(req.cookies).length) {\n    const cookieString = Object.keys(req.cookies).reduce((prev, cookieName) => {\n      const cookieValue = req.cookies[cookieName]\n      const prefix = prev ? '&' : ''\n      const stringified = cookie.serialize(cookieName, cookieValue)\n      return prev + prefix + stringified\n    }, '')\n    req.headers.Cookie = cookieString\n  }\n\n  if (req.cookies) {\n    // even if no cookies were defined, we need to remove\n    // the cookies key from our request, or many many legacy\n    // tests will break.\n    delete req.cookies\n  }\n\n  // Will add the query object into the URL, if it exists\n  // ... will also create a FormData instance, if multipart/form-data (eg: a file)\n  mergeInQueryOrForm(req)\n\n  return req\n}\n\nconst stripNonAlpha = str => (str ? str.replace(/\\W/g, '') : null)\n\nexport function baseUrl(obj) {\n  const specIsOAS3 = isOAS3(obj.spec)\n\n  return specIsOAS3 ? oas3BaseUrl(obj) : swagger2BaseUrl(obj)\n}\n\nfunction oas3BaseUrl({spec, pathName, method, server, contextUrl, serverVariables = {}}) {\n  const servers =\n    getIn(spec, ['paths', pathName, (method || '').toLowerCase(), 'servers']) ||\n    getIn(spec, ['paths', pathName, 'servers']) ||\n    getIn(spec, ['servers'])\n\n  let selectedServerUrl = ''\n  let selectedServerObj = null\n\n  if (server && servers && servers.length) {\n    const serverUrls = servers.map(srv => srv.url)\n\n    if (serverUrls.indexOf(server) > -1) {\n      selectedServerUrl = server\n      selectedServerObj = servers[serverUrls.indexOf(server)]\n    }\n  }\n\n  if (!selectedServerUrl && servers && servers.length) {\n    // default to the first server if we don't have one by now\n    selectedServerUrl = servers[0].url\n    selectedServerObj = servers[0]\n  }\n\n  if (selectedServerUrl.indexOf('{') > -1) {\n    // do variable substitution\n    const varNames = getVariableTemplateNames(selectedServerUrl)\n    varNames.forEach((vari) => {\n      if (selectedServerObj.variables && selectedServerObj.variables[vari]) {\n        // variable is defined in server\n        const variableDefinition = selectedServerObj.variables[vari]\n        const variableValue = serverVariables[vari] || variableDefinition.default\n\n        const re = new RegExp(`{${vari}}`, 'g')\n        selectedServerUrl = selectedServerUrl.replace(re, variableValue)\n      }\n    })\n  }\n\n  return buildOas3UrlWithContext(selectedServerUrl, contextUrl)\n}\n\nfunction buildOas3UrlWithContext(ourUrl = '', contextUrl = '') {\n  const parsedUrl = url.parse(ourUrl)\n  const parsedContextUrl = url.parse(contextUrl)\n\n  const computedScheme = stripNonAlpha(parsedUrl.protocol) || stripNonAlpha(parsedContextUrl.protocol) || ''\n  const computedHost = parsedUrl.host || parsedContextUrl.host\n  const computedPath = parsedUrl.pathname || ''\n  let res\n\n  if (computedScheme && computedHost) {\n    res = `${computedScheme}://${computedHost + computedPath}`\n\n    // If last character is '/', trim it off\n  }\n  else {\n    res = computedPath\n  }\n\n  return res[res.length - 1] === '/' ? res.slice(0, -1) : res\n}\n\nfunction getVariableTemplateNames(str) {\n  const results = []\n  const re = /{([^}]+)}/g\n  let text\n\n  // eslint-disable-next-line no-cond-assign\n  while (text = re.exec(str)) {\n    results.push(text[1])\n  }\n  return results\n}\n\n// Compose the baseUrl ( scheme + host + basePath )\nfunction swagger2BaseUrl({spec, scheme, contextUrl = ''}) {\n  const parsedContextUrl = url.parse(contextUrl)\n  const firstSchemeInSpec = Array.isArray(spec.schemes) ? spec.schemes[0] : null\n\n  const computedScheme = scheme || firstSchemeInSpec || stripNonAlpha(parsedContextUrl.protocol) || 'http'\n  const computedHost = spec.host || parsedContextUrl.host || ''\n  const computedPath = spec.basePath || ''\n  let res\n\n  if (computedScheme && computedHost) {\n    // we have what we need for an absolute URL\n    res = `${computedScheme}://${computedHost + computedPath}`\n  }\n  else {\n    // if not, a relative URL will have to do\n    res = computedPath\n  }\n\n  // If last character is '/', trim it off\n  return res[res.length - 1] === '/' ? res.slice(0, -1) : res\n}\n","import cloneDeep from 'lodash/cloneDeep'\nimport assign from 'lodash/assign'\nimport startsWith from 'lodash/startsWith'\nimport Url from 'url'\nimport Http, {makeHttp, serializeRes, serializeHeaders} from './http'\nimport Resolver, {clearCache} from './resolver'\nimport resolveSubtree from './subtree-resolver'\nimport {makeApisTagOperation} from './interfaces'\nimport {execute, buildRequest} from './execute'\nimport {opId} from './helpers'\n\nSwagger.http = Http\nSwagger.makeHttp = makeHttp.bind(null, Swagger.http)\nSwagger.resolve = Resolver\nSwagger.resolveSubtree = resolveSubtree\nSwagger.execute = execute\nSwagger.serializeRes = serializeRes\nSwagger.serializeHeaders = serializeHeaders\nSwagger.clearCache = clearCache\nSwagger.makeApisTagOperation = makeApisTagOperation\nSwagger.buildRequest = buildRequest\nSwagger.helpers = {opId}\n\nfunction Swagger(url, opts = {}) {\n  // Allow url as a separate argument\n  if (typeof url === 'string') {\n    opts.url = url\n  }\n  else {\n    opts = url\n  }\n\n  if (!(this instanceof Swagger)) {\n    return new Swagger(opts)\n  }\n\n  assign(this, opts)\n\n  const prom = this.resolve()\n    .then(() => {\n      if (!this.disableInterfaces) {\n        assign(this, Swagger.makeApisTagOperation(this))\n      }\n      return this\n    })\n\n  // Expose this instance on the promise that gets returned\n  prom.client = this\n  return prom\n}\n\nSwagger.prototype = {\n\n  http: Http,\n\n  execute(argHash) {\n    this.applyDefaults()\n\n    return Swagger.execute({\n      spec: this.spec,\n      http: this.http,\n      securities: {authorized: this.authorizations},\n      contextUrl: typeof this.url === 'string' ? this.url : undefined,\n      ...argHash\n    })\n  },\n\n  resolve() {\n    return Swagger.resolve({\n      spec: this.spec,\n      url: this.url,\n      allowMetaPatches: this.allowMetaPatches,\n      useCircularStructures: this.useCircularStructures,\n      requestInterceptor: this.requestInterceptor || null,\n      responseInterceptor: this.responseInterceptor || null\n    }).then((obj) => {\n      this.originalSpec = this.spec\n      this.spec = obj.spec\n      this.errors = obj.errors\n      return this\n    })\n  }\n}\n\nSwagger.prototype.applyDefaults = function () {\n  const spec = this.spec\n  const specUrl = this.url\n  // TODO: OAS3: support servers here\n  if (specUrl && startsWith(specUrl, 'http')) {\n    const parsed = Url.parse(specUrl)\n    if (!spec.host) {\n      spec.host = parsed.host\n    }\n    if (!spec.schemes) {\n      spec.schemes = [parsed.protocol.replace(':', '')]\n    }\n    if (!spec.basePath) {\n      spec.basePath = '/'\n    }\n  }\n}\n\nexport default Swagger\n"],"sourceRoot":""}